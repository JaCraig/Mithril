(function(t,f){typeof exports=="object"&&typeof module<"u"?module.exports=f(require("vue"),require("moment")):typeof define=="function"&&define.amd?define(["vue","moment"],f):(t=typeof globalThis<"u"?globalThis:t||self,t.admin=f(t.Vue,t.moment))})(this,function(t,f){"use strict";var _a=Object.defineProperty;var Ua=(t,f,E)=>f in t?_a(t,f,{enumerable:!0,configurable:!0,writable:!0,value:E}):t[f]=E;var Z=(t,f,E)=>(Ua(t,typeof f!="symbol"?f+"":f,E),E);class E{constructor(n){this.outputFormat=n??"[{Timestamp}]	[{Level}]	{Message}{Exception}"}format(n){return this.outputFormat.replace(/{(\w+)}/g,(a,r)=>r==="Timestamp"?n.timestamp.toISOString():r==="Level"?n.level:r==="Message"?n.message:r==="Exception"?n.exception?`
`+n.exception.stack:"":n.properties[r])}}class X{constructor(n="Debug"){this.allowedLevels=["Verbose","Debug","Information","Warning","Error","Fatal"],this.minimumLevel=n,this.allowedLevels=this.allowedLevels.slice(this.allowedLevels.indexOf(n))}filter(n){return this.allowedLevels.indexOf(n.level)>=0}}class x{constructor(){this.styles={Verbose:"color: white;",Debug:"color: green",Information:"color: blue",Warning:"color: yellow",Error:"color: red",Fatal:"color: palevioletred"},this.consoleMethods={Verbose:(n,a,r)=>{console.log(n,a,r)},Debug:(n,a,r)=>{console.debug(n,a,r)},Information:(n,a,r)=>{console.info(n,a,r)},Warning:(n,a,r)=>{console.warn(n,a,r)},Error:(n,a,r)=>{console.error(n,a,r)},Fatal:(n,a,r)=>{console.error(n,a,r)}}}write(n){let a=n.args&&typeof n.args!="object",r=n.args&&typeof n.args=="object";this.consoleMethods[n.level]("%c"+n.message,this.styles[n.level],a?n.args:""),r&&console.table(n.args)}}class v{constructor(n){this.filters=[],this.enrichers=[],this.loggerConfiguration=n}writeTo(n){return this.sink=n,this.loggerConfiguration}minimumLevel(n){return this.filters.push(new X(n)),this}filter(n){return this.filters.push(n),this}formatUsing(n){return this.formatter=n,this}enrichWith(n){return this.enrichers.push(n),this}process(n){this.formatter??(this.formatter=new E),this.sink??(this.sink=new x);let a=Object.assign({},n);this.filters.some(r=>r.filter(a))&&(this.enrichers.forEach(r=>r.enrich(a)),a.message=this.formatter.format(a)||a.message,this.sink.write(a))}}class V{constructor(){this.pipelines=[]}writeTo(n){let a=new v(this);return this.pipelines.push(a),a.writeTo(n)}minimumLevel(n){let a=new v(this);return this.pipelines.push(a),a.minimumLevel(n)}filter(n){let a=new v(this);return this.pipelines.push(a),a.filter(n)}formatUsing(n){let a=new v(this);return this.pipelines.push(a),a.formatUsing(n)}enrichWith(n){let a=new v(this);return this.pipelines.push(a),a.enrichWith(n)}write(n,a,r,i){let s={level:n,message:a,properties:{},exception:i,timestamp:new Date,args:r};this.pipelines.forEach(o=>o.process(s))}}class d{constructor(){}static configure(){return this.loggerConfiguration??(this.loggerConfiguration=window.LoggerConfiguration||new V),window.LoggerConfiguration=this.loggerConfiguration,this.loggerConfiguration}static write(n,a,r,i){d.configure().write(n,a,r,i)}static verbose(n,a){this.write("Verbose",n,a)}static debug(n,a){this.write("Debug",n,a)}static information(n,a){this.write("Information",n,a)}static warning(n,a){this.write("Warning",n,a)}static error(n,a,r){this.write("Error",n,a,r)}static fatal(n,a,r){this.write("Fatal",n,a,r)}}class ee{constructor(n,a,r){this.dbName=n,this.tables=a,this.version=r;const i=indexedDB.open(n,r);i.onupgradeneeded=s=>{this.database=s.target.result;for(const o of a)this.database.objectStoreNames.contains(o)&&this.database.deleteObjectStore(o),this.database.createObjectStore(o)},i.onsuccess=s=>{this.database=s.target.result},i.onerror=s=>{d.error("Failed to open the database:",s.target.error)}}openDatabase(){return new Promise((n,a)=>{const r=indexedDB.open(this.dbName,this.version);r.onsuccess=i=>{this.database=i.target.result,n(this)},r.onerror=i=>{d.error("Failed to open the database:",i.target.error),a(new Error("Failed to open the database:"+i.target.error))}})}add(n,a,r){return new Promise((i,s)=>{const c=this.database.transaction(n,"readwrite").objectStore(n).put(a,r);c.onsuccess=()=>{i()},c.onerror=m=>{d.error("Failed to add an object to the database: ",m.target.error),s(new Error("Failed to add an object to the database: "+m.target.error))}})}remove(n,a){return new Promise((r,i)=>{const l=this.database.transaction(n,"readwrite").objectStore(n).delete(a);l.onsuccess=()=>{r()},l.onerror=c=>{d.error("Failed to remove an object from the database: ",c.target.error),i(new Error("Failed to remove an object from the database: "+c.target.error))}})}getByKey(n,a){return new Promise((r,i)=>{const l=this.database.transaction(n,"readwrite").objectStore(n).get(a);l.onsuccess=c=>{r(c.target.result)},l.onerror=c=>{d.error("Failed to retrieve an object from the database: ",c.target.error),i(new Error("Failed to retrieve an object from the database: "+c.target.error))}})}getKeys(n){return new Promise((a,r)=>{const o=this.database.transaction(n,"readwrite").objectStore(n).getAllKeys();o.onsuccess=l=>{a(l.target.result)},o.onerror=l=>{d.error("Failed to retrieve an object from the database: ",l.target.error),r(new Error("Failed to retrieve keys from the database: "+l.target.error))}})}get(n,a){return new Promise((r,i)=>{const l=this.database.transaction(n,"readwrite").objectStore(n).get(a);l.onsuccess=c=>{r(c.target.result)},l.onerror=c=>{d.error("Failed to retrieve an object from the database: ",c.target.error),i(new Error("Failed to retrieve an object from the database: "+c.target.error))}})}getAll(n,a){return new Promise((r,i)=>{const l=this.database.transaction(n,"readwrite").objectStore(n).getAll(a);l.onsuccess=c=>{r(c.target.result)},l.onerror=c=>{d.error("Failed to retrieve an object from the database: ",c.target.error),i(new Error("Failed to retrieve objects from the database: "+c.target.error))}})}}class L{constructor(){this.database=new ee("cacheStore",["cache","cacheEntryOptions"],1)}async clear(){await this.database.openDatabase();let n=await this.database.getAll("cacheEntryOptions"),a=await this.database.getAll("cache");for(let r=0;r<n.length;r++){let i=a[r];await this.remove(i.key)}return this}async getOptions(n){return await this.database.openDatabase(),this.database.getByKey("cacheEntryOptions",n)}async add(n,a,r){return await this.database.openDatabase(),await this.database.add("cache",n,a),await this.database.add("cacheEntryOptions",r,a),this}async remove(n){return await this.database.openDatabase(),await this.database.remove("cache",n),await this.database.remove("cacheEntryOptions",n),this}async get(n){return await this.database.openDatabase(),this.database.getByKey("cache",n)}async compact(){await this.database.openDatabase();let n=await this.database.getAll("cacheEntryOptions"),a=await this.database.getAll("cache"),r=new Date().getTime();for(let i=0;i<n.length;i++){let s=n[i],o=a[i];s.expirationTime!=0&&s.expirationTime<r&&await this.remove(o.key)}return this}}class M{constructor(){}static configure(n=new L){this.storageProvider??(this.storageProvider=window.StorageProvider||new L),window.StorageProvider=this.storageProvider}static async set(n,a,r={expirationTime:0,slidingExpirationTime:0,sliding:!1}){d.debug("Setting object in cache: ",{key:n,value:a,entryOptions:r}),this.configure(),await this.storageProvider.add(a,n,r)}static async get(n){d.debug("Getting object from cache: "+n),this.configure(),await this.storageProvider.compact();let a=await this.storageProvider.get(n);if(a==null)return a;let r=await this.storageProvider.getOptions(n);return r.sliding&&await this.set(n,a,{expirationTime:new Date().getTime()+r.slidingExpirationTime,slidingExpirationTime:r.slidingExpirationTime,sliding:!0}),a}static async remove(n){d.debug("Removing object from cache: "+n),this.configure(),await this.storageProvider.remove(n)}static async clear(){d.debug("Clearing cache"),this.configure(),await this.storageProvider.clear()}}class te{}class p{constructor(n){this.options={method:"GET",url:"",headers:{},credentials:"same-origin",serializer:JSON.stringify,parser:a=>a.json(),success:a=>{d.debug("Request response from "+this.options.url+":",a)},error:a=>{d.error("Request error from "+this.options.url+":",a)},retry:a=>{d.debug("Request retry on "+this.options.url+":",{attempt:a})},storageMode:0,cacheKey:"",timeout:6e4,retryAttempts:3,retryDelay:1e3},this.abortController=null,this.options={...this.options,...n}}static get(n,a){return new p({method:"GET",url:n,data:a,cacheKey:n+JSON.stringify(a)}).withHeaders({Accept:"application/json"})}static post(n,a){return new p({method:"POST",url:n,data:a,cacheKey:n+JSON.stringify(a),storageMode:2}).withHeaders({"Content-Type":"application/json",Accept:"application/json"})}static put(n,a){return new p({method:"PUT",url:n,data:a,cacheKey:n+JSON.stringify(a),storageMode:2}).withHeaders({"Content-Type":"application/json",Accept:"application/json"})}static delete(n,a){return new p({method:"DELETE",url:n,data:a,cacheKey:n+JSON.stringify(a),storageMode:2}).withHeaders({Accept:"application/json"})}static ofType(n,a,r){return new p({method:n,url:a,data:r,cacheKey:a+JSON.stringify(r)}).withHeaders({Accept:"application/json"})}withAuthenticationProvider(n){return this.options.authenticationProvider=n,this}withHeaders(n){return this.options.headers={...this.options.headers,...n},this}withCancellationToken(n){return this.options.cancellationToken=n,this}withCredentials(n){return this.options.credentials=n,this}withSerializer(n){return this.options.serializer=n,this}withParser(n){return this.options.parser=n,this}onSuccess(n){return this.options.success=n??(a=>{d.debug("Request response:",a)}),this}onError(n){return this.options.error=n??(a=>{d.error("Request error:",a)}),this}onRetry(n){return this.options.retry=n??(a=>{d.debug("Request retry:",{attempt:a})}),this}withStorageMode(n){return this.options.storageMode=n,this}withCacheKey(n){return this.options.cacheKey=n,this}withTimeout(n){return this.options.timeout=n??6e4,this}withRetryAttempts(n){return this.options.retryAttempts=n,this}withRetryDelay(n){return this.options.retryDelay=n,this}abort(){return this.abortController===null?this:(this.abortController.abort(),this.options.error(new Error("The request was aborted.")),this)}async send(){const{authenticationProvider:n,method:a,url:r,data:i,headers:s,credentials:o,serializer:l,parser:c,success:m,error:u,storageMode:S,cacheKey:q,timeout:Oa,retryAttempts:Pa,retryDelay:za,retry:Ra,cancellationToken:I}=this.options,J=new AbortController;this.abortController=J;let j=0,C=null;const W=async()=>{if(S===1||S===3){const g=await M.get(q);if(g!==void 0&&(m(g),S===1))return g}if(!navigator.onLine){if(S===0){const k=await M.get(q);if(k!==void 0)return m(k),k}const g=new Error("System is offline");return u(g),Promise.reject(g)}try{const g=l(i);await(n==null?void 0:n.authenticate(this));const k=await Promise.race([fetch(r,{method:a,credentials:o,headers:s,body:g,signal:J.signal}),this.handleTimeout(Oa)]);if(I!=null&&I.canceled)return Promise.reject(new Error("The request was canceled."));if(k.status>=200&&k.status<300){const A=await c(k);return m(A),S!==2&&await M.set(q,A),A}C=new Error(k.statusText),k.status===401&&await(n==null?void 0:n.authenticationFailed(this,k))}catch(g){C=g}return j<Pa?(++j,await new Promise(g=>setTimeout(g,za)),Ra(j),W()):(u(C),Promise.reject(C))};return W()}async handleTimeout(n){throw n??(n=6e4),await new Promise((a,r)=>{setTimeout(()=>{r(new Error("Request timeout"))},n)}),new Error("Request timeout")}}var $=(e=>(e[e.NetworkFirst=0]="NetworkFirst",e[e.StorageFirst=1]="StorageFirst",e[e.NetworkOnly=2]="NetworkOnly",e[e.StorageAndUpdate=3]="StorageAndUpdate",e))($||{});String.prototype.slugify=function(){return this.trim().replace(/ /g,"-").replace(/-{2,}/g,"-").replace(/^-+|-+$/g,"").replace(/([^a-zA-Z0-9-_/./:]+)/g,"")},String.prototype.stripHTML=function(){let e=document.createElement("div");return e.innerHTML=this,(e.textContent||e.innerText||"").replace(/^\s+|\s+$/g,"")},String.prototype.toNumber=function(){return this==null?0:parseFloat(this.stripHTML().replace(/[^0-9.-]/g,""))};function B(e,n=300){let a;return function(...r){clearTimeout(a),a=setTimeout(()=>{e.apply(this,r)},n)}}class b{}class w{constructor(){this.name="inputElement"}validate(n,...a){let r=n;return r==null?new Promise((i,s)=>{i({isValid:!0,errorMessage:""})}):new Promise((i,s)=>{r.checkValidity()?i({isValid:!0,errorMessage:r.validationMessage}):i({isValid:!1,errorMessage:r.validationMessage})})}}class D{constructor(){this.name="selectElement"}validate(n,...a){let r=n;return r==null?new Promise((i,s)=>{i({isValid:!0,errorMessage:""})}):new Promise((i,s)=>{r.checkValidity()?i({isValid:!0,errorMessage:r.validationMessage}):i({isValid:!1,errorMessage:r.validationMessage})})}}class ne{constructor(){this.name="textAreaElement"}validate(n,...a){let r=n;return r==null?new Promise((i,s)=>{i({isValid:!0,errorMessage:""})}):new Promise((i,s)=>{r.checkValidity()?i({isValid:!0,errorMessage:r.validationMessage}):i({isValid:!1,errorMessage:r.validationMessage})})}}class ae{constructor(){}static initialize(){this.rules??(this.rules=window.ValidationConfiguration||{}),window.ValidationConfiguration=this.rules}static addRuleGroup(n,a){this.initialize(),this.rules[n]=a}static async validate(n,a,r={}){this.initialize();let i=!0,s=this.rules[a];if(!s)return i;for(let o in s){if(!s.hasOwnProperty(o))continue;let l=n[o],c=s[o];for(let m=0;m<c.length;m++){let S=await c[m].validate(l);S.isValid||(i=!1,r.hasOwnProperty(o)?r[o].push(S.errorMessage):r[o]=[S.errorMessage])}}return i}static async validateForm(n,a=null,r={}){this.initialize(),a??(a=n.getAttribute("data-validation-rule-group")),a||(a=this.deriveObjectType(n));let i=this.rules[a];i||(i=this.extractRulesFromForm(n),this.addRuleGroup(a,i));const s=this.extractFormData(n);return this.validate(s,a,r)}static extractFormData(n){let a={},r=n.getElementsByTagName("input"),i=n.getElementsByTagName("textarea"),s=n.getElementsByTagName("select");for(let o=0;o<r.length;o++)a[r[o].name]=r[o];for(let o=0;o<i.length;o++)a[i[o].name]=i[o];for(let o=0;o<s.length;o++)a[s[o].name]=s[o];return a}static deriveObjectType(n){return n.action||n.id||n.name}static extractRulesFromForm(n){var o,l,c;let a={},r=n.getElementsByTagName("input"),i=n.getElementsByTagName("textarea"),s=n.getElementsByTagName("select");for(let m=0;m<r.length;++m){let u=r[m];u.willValidate&&(a[o=u.name]??(a[o]=[]),a[u.name].push(new w))}for(let m=0;m<i.length;++m){let u=i[m];u.willValidate&&(a[l=u.name]??(a[l]=[]),a[u.name].push(new ne))}for(let m=0;m<s.length;++m){let u=s[m];u.willValidate&&(a[c=u.name]??(a[c]=[]),a[u.name].push(new D))}return a}}const re=t.defineComponent({name:"form-field-input",data:function(){return{internalModel:this.formatValue(this.model),internalSchema:this.schema,dataListQuery:"query($queryType: String!, $queryFilter: String!) { dropDown(type: $queryType, filter: $queryFilter) { key, value } }",errorMessage:""}},props:{model:{type:String,required:!0,default:""},schema:{type:b,required:!0,default:()=>new b},showLabel:{type:Boolean,required:!1,default:!0}},methods:{willValidate:function(){return this.internalSchema.metadata.required||this.internalSchema.metadata.maxlength||this.internalSchema.metadata.minlength||this.internalSchema.metadata.pattern||this.internalSchema.metadata.min||this.internalSchema.metadata.max},revalidate:async function(){let e=document.getElementById(this.getFieldID());if(e==null)return;let n=await new w().validate(e);return this.errorMessage=n.errorMessage,n.isValid},convertToDate:function(e){return this.schema.metadata.isUTC?f.utc(e||new Date).local():f(e||new Date)},formatValue:function(e){return e&&(this.schema.metadata.inputType==="date"?this.convertToDate(e).format("YYYY-MM-DD"):this.schema.metadata.inputType==="datetime-local"||this.schema.metadata.inputType==="datetime"?this.convertToDate(e).format("YYYY-MM-DDTHH:mm"):this.schema.metadata.inputType==="month"?this.convertToDate(e).format("YYYY-MM"):e)},getFieldID:function(){return this.internalSchema.propertyName.slugify()+this.internalSchema.key},changed:function(e){this.updateDataList(),this.revalidate(),this.$emit("changed",e,this.schema)},getList:function(){return this.schema.metadata.datalist?this.getFieldID()+"-list":null},updateDataList:B(async function(){if(!this.internalSchema.queryType)return;let e=this;p.post("/api/query",{query:e.datalistQuery,variables:{queryType:e.internalSchema.metadata.queryType,queryFilter:e.internalModel}}).onSuccess(n=>{d.debug("Select: "+e.internalSchema.metadata.queryType+" loaded successfully.",n.data.dropDown),e.internalSchema.metadata.datalist=n.data.dropDown}).onError(n=>{d.error("Select: "+e.internalSchema.metadata.queryType+" failed to load.",n)}).withStorageMode($.StorageAndUpdate).send()},300)},created:function(){this.updateDataList()},watch:{model:function(e,n){n!==e&&(this.internalModel=e,this.$nextTick(function(){this.revalidate()}))},schema:function(e,n){n!==e&&(this.internalSchema=e,this.$nextTick(function(){this.revalidate()}))}},mounted:function(){this.$nextTick(function(){this.revalidate()})}}),h=(e,n)=>{const a=e.__vccOpts||e;for(const[r,i]of n)a[r]=i;return a},oe=["for"],ie={key:0,class:"error clear-background"},se={key:1,class:"clear-background active no-border small"},le=t.createElementVNode("span",{class:"fas fa-info-circle"},null,-1),ce={key:2,class:"error clear-background"},de={key:3,class:"success clear-background fas fa-check-circle"},me={key:1},he=["id","type","disabled","accept","alt","autocomplete","checked","dirname","formaction","formenctype","formmethod","formnovalidate","formtarget","height","list","max","maxlength","min","minlength","multiple","name","pattern","placeholder","title","readonly","required","size","src","step","width","files","data-error-message-value-missing","data-error-message-pattern-mismatch","data-error-message-range-overflow","data-error-message-range-underflow","data-error-message-step-mismatch","data-error-message-too-long","data-error-message-too-short","data-error-message-bad-input","data-error-message-type-mismatch"],pe={key:2,class:"text-center"},fe=["id"],ue=["value"];function ge(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",null,[e.showLabel&&e.internalSchema.displayName?(t.openBlock(),t.createElementBlock("label",{key:0,for:e.getFieldID()},[t.createTextVNode(t.toDisplayString(e.internalSchema.displayName)+" ",1),e.internalSchema.metadata.required&&e.errorMessage?(t.openBlock(),t.createElementBlock("span",ie,"*")):t.createCommentVNode("",!0),e.internalSchema.metadata.hint?(t.openBlock(),t.createElementBlock("i",se,[le,t.createTextVNode(t.toDisplayString(e.internalSchema.metadata.hint),1)])):t.createCommentVNode("",!0),e.errorMessage?(t.openBlock(),t.createElementBlock("span",ce,t.toDisplayString(e.errorMessage),1)):t.createCommentVNode("",!0),!e.errorMessage&&e.willValidate()?(t.openBlock(),t.createElementBlock("span",de)):t.createCommentVNode("",!0)],8,oe)):t.createCommentVNode("",!0),e.internalSchema.metadata.subtitle?(t.openBlock(),t.createElementBlock("div",me,t.toDisplayString(e.internalSchema.metadata.subtitle),1)):t.createCommentVNode("",!0),t.withDirectives(t.createElementVNode("input",{id:e.getFieldID(),type:e.internalSchema.metadata.inputType,"onUpdate:modelValue":n[0]||(n[0]=o=>e.internalModel=o),onInput:n[1]||(n[1]=o=>e.changed(o.target.value)),disabled:e.internalSchema.metadata.disabled,accept:e.internalSchema.metadata.accept,alt:e.internalSchema.metadata.alt,autocomplete:e.internalSchema.metadata.autocomplete,checked:e.internalSchema.metadata.checked,dirname:e.internalSchema.metadata.dirname,formaction:e.internalSchema.metadata.formaction,formenctype:e.internalSchema.metadata.formenctype,formmethod:e.internalSchema.metadata.formmethod,formnovalidate:e.internalSchema.metadata.formnovalidate,formtarget:e.internalSchema.metadata.formtarget,height:e.internalSchema.metadata.height,list:e.getList(),max:e.internalSchema.metadata.max,maxlength:e.internalSchema.metadata.maxlength,min:e.internalSchema.metadata.min,minlength:e.internalSchema.metadata.minlength,multiple:e.internalSchema.metadata.multiple,name:e.getFieldID(),pattern:e.internalSchema.metadata.pattern,placeholder:e.internalSchema.metadata.placeholder,title:e.internalSchema.metadata.placeholder,readonly:e.internalSchema.metadata.readonly,required:e.internalSchema.metadata.required,size:e.internalSchema.metadata.size,src:e.internalSchema.metadata.src,step:e.internalSchema.metadata.step,width:e.internalSchema.metadata.width,files:e.internalSchema.metadata.files,"data-error-message-value-missing":e.internalSchema.metadata.errorMessageValueMissing,"data-error-message-pattern-mismatch":e.internalSchema.metadata.errorMessagePatternMismatch,"data-error-message-range-overflow":e.internalSchema.metadata.errorMessageRangeOverflow,"data-error-message-range-underflow":e.internalSchema.metadata.errorMessageRangeUnderflow,"data-error-message-step-mismatch":e.internalSchema.metadata.errorMessageStepMismatch,"data-error-message-too-long":e.internalSchema.metadata.errorMessageTooLong,"data-error-message-too-short":e.internalSchema.metadata.errorMessageTooShort,"data-error-message-bad-input":e.internalSchema.metadata.errorMessageBadInput,"data-error-message-type-mismatch":e.internalSchema.metadata.errorMessageTypeMismatch},null,40,he),[[t.vModelDynamic,e.internalModel]]),e.internalSchema.metadata.inputType==="color"||e.internalSchema.metadata.inputType==="range"?(t.openBlock(),t.createElementBlock("div",pe,t.toDisplayString(e.internalModel),1)):t.createCommentVNode("",!0),e.internalSchema.metadata.datalist?(t.openBlock(),t.createElementBlock("datalist",{key:3,id:e.getList()},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.internalSchema.metadata.datalist,o=>(t.openBlock(),t.createElementBlock("option",{value:o.value,key:o.key},null,8,ue))),128))],8,fe)):t.createCommentVNode("",!0)])}const O=h(re,[["render",ge]]),ye=t.defineComponent({name:"form-field-select",data:function(){return{internalModel:this.model,internalSchema:this.schema,optionsQuery:"query($queryType: String!) { dropDown(type: $queryType) { key, value } }",errorMessage:""}},props:{model:{type:String,required:!0,default:""},schema:{type:b,required:!0,default:()=>new b},showLabel:{type:Boolean,required:!1,default:!0}},methods:{willValidate:function(){return this.internalSchema.metadata.required},revalidate:async function(){let e=await new D().validate(document.getElementById(this.getFieldID()));return this.errorMessage=e.errorMessage,e.isValid},getFieldID:function(){return this.internalSchema.propertyName.slugify()+this.internalSchema.key},changed:function(e){this.revalidate(),this.$emit("changed",e,this.schema)},isSelected:function(e){return this.internalModel===e.key},getValues:async function(){if(!this.internalSchema.metadata.queryType)return;let e=this;d.debug("Select: Getting values for "+this.internalSchema.metadata.queryType),await p.post("/api/query",{query:e.optionsQuery,variables:{queryType:e.internalSchema.metadata.queryType}}).onSuccess(n=>{d.debug("Select: "+e.internalSchema.metadata.queryType+" loaded successfully.",n.data.dropDown),e.internalSchema.metadata.options=n.data.dropDown}).onError(n=>{d.error("Select: "+e.internalSchema.metadata.queryType+" failed to load.",n)}).withStorageMode($.StorageAndUpdate).send()}},created:function(){this.getValues()},watch:{model:function(e,n){n!==e&&(this.internalModel=e,this.$nextTick(function(){this.revalidate()}))},schema:function(e,n){n!==e&&(this.internalSchema=e,this.$nextTick(function(){this.revalidate()}))}},mounted:function(){this.$nextTick(function(){this.revalidate()})}}),ke=["for"],Se={key:0,class:"error clear-background"},be={key:1,class:"clear-background active no-border small"},Ee=t.createElementVNode("span",{class:"fas fa-info-circle"},null,-1),$e={key:2,class:"error clear-background"},ve={key:3,class:"success clear-background fas fa-check-circle"},we={key:1},Be=["disabled","name","height","id","readonly","required","multiple","width","data-error-message-value-missing"],Ne=["value","selected"];function Ce(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",null,[e.showLabel&&e.internalSchema.displayName?(t.openBlock(),t.createElementBlock("label",{key:0,for:e.getFieldID()},[t.createTextVNode(t.toDisplayString(e.internalSchema.displayName)+" ",1),e.internalSchema.metadata.required&&e.errorMessage?(t.openBlock(),t.createElementBlock("span",Se,"*")):t.createCommentVNode("",!0),e.internalSchema.metadata.hint?(t.openBlock(),t.createElementBlock("i",be,[Ee,t.createTextVNode(t.toDisplayString(e.internalSchema.metadata.hint),1)])):t.createCommentVNode("",!0),e.errorMessage?(t.openBlock(),t.createElementBlock("span",$e,t.toDisplayString(e.errorMessage),1)):t.createCommentVNode("",!0),!e.errorMessage&&e.willValidate()?(t.openBlock(),t.createElementBlock("span",ve)):t.createCommentVNode("",!0)],8,ke)):t.createCommentVNode("",!0),e.internalSchema.metadata.subtitle?(t.openBlock(),t.createElementBlock("div",we,t.toDisplayString(e.internalSchema.metadata.subtitle),1)):t.createCommentVNode("",!0),t.withDirectives(t.createElementVNode("select",{"onUpdate:modelValue":n[0]||(n[0]=o=>e.internalModel=o),disabled:e.internalSchema.metadata.disabled,name:e.internalSchema.metadata.inputName||e.getFieldID(),height:e.internalSchema.metadata.height,id:e.getFieldID(),onChange:n[1]||(n[1]=o=>e.changed(e.internalModel)),readonly:e.internalSchema.metadata.readonly,required:e.internalSchema.metadata.required,multiple:e.internalSchema.metadata.multiple,class:t.normalizeClass(e.internalSchema.metadata.inputClasses),width:e.internalSchema.metadata.width,"data-error-message-value-missing":e.internalSchema.metadata.errorMessageValueMissing},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.internalSchema.metadata.options,o=>(t.openBlock(),t.createElementBlock("option",{value:o.key,selected:e.isSelected(o),key:o.key},t.toDisplayString(o.value),9,Ne))),128))],42,Be),[[t.vModelSelect,e.internalModel]])])}const P=h(ye,[["render",Ce]]),Me=t.defineComponent({name:"form-field-checkbox",data:function(){return{internalModel:this.model,internalSchema:this.schema,errorMessage:""}},props:{model:{type:Boolean,required:!0,default:!1},schema:{type:b,required:!0,default:()=>new b},showLabel:{type:Boolean,required:!1,default:!0}},methods:{willValidate:function(){return this.internalSchema.metadata.required},revalidate:async function(){let e=document.getElementById(this.getFieldID());if(e==null)return;let n=await new w().validate(e);return this.errorMessage=n.errorMessage,n.isValid},getFieldID:function(){return this.internalSchema.propertyName.slugify()+this.internalSchema.key},changed:function(e){this.revalidate(),this.$emit("changed",e,this.schema)}},watch:{model:function(e,n){n!==e&&(this.internalModel=e,this.$nextTick(function(){this.revalidate()}))},schema:function(e,n){n!==e&&(this.internalSchema=e,this.$nextTick(function(){this.revalidate()}))}},mounted:function(){this.$nextTick(function(){this.revalidate()})}}),De=["for"],Te={key:0},Fe={key:1,class:"error clear-background"},qe={key:2,class:"error clear-background"},Ie={key:3,class:"success clear-background fas fa-check-circle"},je={key:4},Ae=["id","checked","disabled","dirname","name","readonly","required"];function Le(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",null,[t.createElementVNode("label",{for:e.getFieldID()},[e.showLabel&&e.internalSchema.displayName?(t.openBlock(),t.createElementBlock("span",Te,t.toDisplayString(e.internalSchema.displayName),1)):t.createCommentVNode("",!0),e.internalSchema.metadata.required&&e.errorMessage?(t.openBlock(),t.createElementBlock("span",Fe,"*")):t.createCommentVNode("",!0),e.errorMessage?(t.openBlock(),t.createElementBlock("span",qe,t.toDisplayString(e.errorMessage),1)):t.createCommentVNode("",!0),!e.errorMessage&&e.willValidate()?(t.openBlock(),t.createElementBlock("span",Ie)):t.createCommentVNode("",!0),e.internalSchema.metadata.subtitle?(t.openBlock(),t.createElementBlock("div",je,t.toDisplayString(e.internalSchema.metadata.subtitle),1)):t.createCommentVNode("",!0),t.createElementVNode("input",{id:e.getFieldID(),type:"checkbox",checked:e.internalModel,onClick:n[0]||(n[0]=o=>e.changed(o.target.checked)),disabled:e.internalSchema.metadata.disabled,dirname:e.internalSchema.metadata.dirname,name:e.getFieldID(),readonly:e.internalSchema.metadata.readonly,required:e.internalSchema.metadata.required},null,8,Ae)],8,De)])}const z=h(Me,[["render",Le]]),Oe=t.defineComponent({name:"form-field-radio",data:function(){return{internalModel:this.model,internalSchema:this.schema,optionsQuery:"query($queryType: String!) { dropDown(type: $queryType) { key, value } }",errorMessage:""}},props:{model:{type:String,required:!0,default:""},schema:{type:b,required:!0,default:()=>new b},showLabel:{type:Boolean,required:!1,default:!0}},methods:{willValidate:function(){return this.internalSchema.metadata.required},revalidate:async function(){let e=await new D().validate(document.getElementById(this.getFieldID()));return this.errorMessage=e.errorMessage,e.isValid},getFieldID:function(){if(this.internalSchema!=null)return this.internalSchema.propertyName.slugify()+this.internalSchema.key},getFieldName:function(){return this.internalSchema.id?this.internalSchema.id:this.internalSchema.propertyName.slugify()},changed:function(e){this.revalidate(),this.$emit("changed",e,this.schema)},isItemChecked:function(e){return e===this.internalModel},isSelected:function(e){return this.internalModel===e.key},getValues:async function(){if(!this.internalSchema.metadata.queryType)return;let e=this;d.debug("Select: Getting values for "+this.internalSchema.metadata.queryType),await p.post("/api/query",{query:e.optionsQuery,variables:{queryType:e.internalSchema.metadata.queryType}}).onSuccess(n=>{d.debug("Select: "+e.internalSchema.metadata.queryType+" loaded successfully.",n.data.dropDown),e.internalSchema.metadata.options=n.data.dropDown}).onError(n=>{d.error("Select: "+e.internalSchema.metadata.queryType+" failed to load.",n)}).withStorageMode($.StorageAndUpdate).send()}},created:function(){this.getValues()},watch:{model:function(e,n){n!==e&&(this.internalModel=e,this.$nextTick(function(){this.revalidate()}))},schema:function(e,n){n!==e&&(this.internalSchema=e,this.$nextTick(function(){this.revalidate()}))}},mounted:function(){this.$nextTick(function(){this.revalidate()})}}),Pe=["for"],ze={key:0,class:"error clear-background"},Re={key:1,class:"clear-background active no-border small"},_e=t.createElementVNode("span",{class:"fas fa-info-circle"},null,-1),Ue={key:2,class:"error clear-background"},Ye={key:3,class:"success clear-background fas fa-check-circle"},Ke={key:1},Ge={class:"flex row text-center"},He=["id","checked","onClick","disabled","name","readonly","value"];function Qe(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",null,[e.showLabel&&e.internalSchema.displayName?(t.openBlock(),t.createElementBlock("label",{key:0,for:e.getFieldID()},[t.createTextVNode(t.toDisplayString(e.internalSchema.displayName)+" ",1),e.internalSchema.metadata.required&&e.errorMessage?(t.openBlock(),t.createElementBlock("span",ze,"*")):t.createCommentVNode("",!0),e.internalSchema.metadata.hint?(t.openBlock(),t.createElementBlock("i",Re,[_e,t.createTextVNode(t.toDisplayString(e.internalSchema.metadata.hint),1)])):t.createCommentVNode("",!0),e.errorMessage?(t.openBlock(),t.createElementBlock("span",Ue,t.toDisplayString(e.errorMessage),1)):t.createCommentVNode("",!0),!e.errorMessage&&e.willValidate()?(t.openBlock(),t.createElementBlock("span",Ye)):t.createCommentVNode("",!0)],8,Pe)):t.createCommentVNode("",!0),e.internalSchema.metadata.subtitle?(t.openBlock(),t.createElementBlock("div",Ke,t.toDisplayString(e.internalSchema.metadata.subtitle),1)):t.createCommentVNode("",!0),t.createElementVNode("div",Ge,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.internalSchema.metadata.options,o=>(t.openBlock(),t.createElementBlock("div",{key:o.key},[t.createElementVNode("label",null,[t.createElementVNode("input",{id:e.getFieldID(o.key),type:"radio",checked:e.isItemChecked(o.key),onClick:l=>e.changed(o.key),disabled:e.internalSchema.metadata.disabled,name:e.internalSchema.metadata.inputName||e.getFieldName(),readonly:e.internalSchema.metadata.readonly,class:t.normalizeClass(e.internalSchema.metadata.inputClasses),value:o.key},null,10,He),t.createTextVNode(" "+t.toDisplayString(e.$filters.capitalize(o.value)),1)])]))),128))])])}const R=h(Oe,[["render",Qe]]),Je=t.defineComponent({data:function(){return{internalModel:this.model,errorMessage:""}},props:{model:Object,schema:Object,idSuffix:String,label:{default:!0,type:Boolean}},computed:{charactersRemaining:function(){return this.internalModel==null?0:this.schema.maxlength-this.internalModel.length}},methods:{willValidate:function(){return this.internalSchema.metadata.required||this.internalSchema.metadata.maxlength||this.internalSchema.metadata.minlength||this.internalSchema.metadata.pattern||this.internalSchema.metadata.min||this.internalSchema.metadata.max},revalidate:async function(){let e=await new w().validate(document.getElementById(this.getFieldID()));return this.errorMessage=e.errorMessage,e.isValid},getFieldID:function(){let e="";return this.schema.id?e=this.schema.id:e=this.schema.model.slugify(),this.idSuffix!==void 0&&(e+=this.idSuffix),e},changed:function(e){this.revalidate(),this.$emit("changed",e,this.schema)}},watch:{model:function(e,n){n!==e&&(this.internalModel=e,this.$nextTick(function(){this.revalidate()}))}},mounted:function(){this.$nextTick(function(){this.revalidate()})}}),We=["for"],Ze={key:0,class:"error clear-background"},Xe={key:1,class:"clear-background active no-border small"},xe=t.createElementVNode("span",{class:"fas fa-info-circle"},null,-1),Ve={key:2,class:"error clear-background"},et={key:3,class:"success clear-background fas fa-check-circle"},tt=["for"],nt={key:0,class:"error clear-background"},at={key:1,class:"clear-background active no-border small"},rt=t.createElementVNode("span",{class:"fas fa-info-circle"},null,-1),ot={key:2,class:"error clear-background"},it={key:3,class:"success clear-background fas fa-check-circle"},st={key:2},lt=["id","disabled","height","maxlength","minlength","name","placeholder","title","readonly","required","width","rows","data-error-message-value-missing","data-error-message-too-long","data-error-message-too-short"],ct={key:3,class:"clear-background active right small"},dt=t.createElementVNode("span",{class:"fas fa-info-circle"},null,-1),mt=t.createElementVNode("br",{class:"clear"},null,-1);function ht(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",null,[t.createTextVNode(" Text Area "),!e.schema.label&&e.label?(t.openBlock(),t.createElementBlock("label",{key:0,for:e.getFieldID(),class:t.normalizeClass(e.schema.labelClasses)},[t.createTextVNode(t.toDisplayString(e.$filters.capitalize(e.schema.model))+" ",1),e.schema.required&&e.errorMessage?(t.openBlock(),t.createElementBlock("span",Ze,"*")):t.createCommentVNode("",!0),e.schema.hint?(t.openBlock(),t.createElementBlock("i",Xe,[xe,t.createTextVNode(t.toDisplayString(e.schema.hint),1)])):t.createCommentVNode("",!0),e.errorMessage?(t.openBlock(),t.createElementBlock("span",Ve,t.toDisplayString(e.errorMessage),1)):t.createCommentVNode("",!0),!e.errorMessage&&e.willValidate()?(t.openBlock(),t.createElementBlock("span",et)):t.createCommentVNode("",!0)],10,We)):t.createCommentVNode("",!0),e.schema.label&&e.label?(t.openBlock(),t.createElementBlock("label",{key:1,for:e.getFieldID(),class:t.normalizeClass(e.schema.labelClasses)},[t.createTextVNode(t.toDisplayString(e.schema.label)+" ",1),e.schema.required&&e.errorMessage?(t.openBlock(),t.createElementBlock("span",nt,"*")):t.createCommentVNode("",!0),e.schema.hint?(t.openBlock(),t.createElementBlock("i",at,[rt,t.createTextVNode(t.toDisplayString(e.schema.hint),1)])):t.createCommentVNode("",!0),e.errorMessage?(t.openBlock(),t.createElementBlock("span",ot,t.toDisplayString(e.errorMessage),1)):t.createCommentVNode("",!0),!e.errorMessage&&e.willValidate()?(t.openBlock(),t.createElementBlock("span",it)):t.createCommentVNode("",!0)],10,tt)):t.createCommentVNode("",!0),e.internalSchema.metadata.subtitle?(t.openBlock(),t.createElementBlock("div",st,t.toDisplayString(e.internalSchema.metadata.subtitle),1)):t.createCommentVNode("",!0),t.withDirectives(t.createElementVNode("textarea",{id:e.getFieldID(),"onUpdate:modelValue":n[0]||(n[0]=o=>e.internalModel=o),onInput:n[1]||(n[1]=o=>e.changed(o.target.value)),disabled:e.schema.disabled,height:e.schema.height,maxlength:e.schema.maxlength,minlength:e.schema.minlength,name:e.schema.inputName||e.getFieldID(),placeholder:e.schema.placeholder,title:e.schema.placeholder,readonly:e.schema.readonly,class:t.normalizeClass(e.schema.inputClasses),required:e.schema.required,width:e.schema.width,rows:e.schema.rows||3,"data-error-message-value-missing":e.schema.errorMessageValueMissing,"data-error-message-too-long":e.schema.errorMessageTooLong,"data-error-message-too-short":e.schema.errorMessageTooShort},`\r
        `,42,lt),[[t.vModelText,e.internalModel]]),e.schema.maxlength?(t.openBlock(),t.createElementBlock("div",ct,[dt,t.createTextVNode(" "+t.toDisplayString(e.charactersRemaining)+" characters remaining ("+t.toDisplayString(e.schema.maxlength)+" max) ",1)])):t.createCommentVNode("",!0),mt])}const _=h(Je,[["render",ht]]),pt=t.defineComponent({data:function(){return{internalModel:this.model}},props:{model:Object,schema:Object,idSuffix:String},methods:{},watch:{model:function(e,n){n!==e&&(this.internalModel=e)}}}),ft=["innerHTML"];function ut(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",null,[t.createTextVNode(" Text "),t.createElementVNode("div",{class:t.normalizeClass(e.schema.classes),innerHTML:e.internalModel||e.schema.model},null,10,ft)])}const U=h(pt,[["render",ut]]),gt=t.defineComponent({data(){return{files:[],ready:!1,filesAdded:0,internalModel:this.model,errorMessage:""}},props:{model:Object,schema:Object,idSuffix:String},methods:{willValidate:function(){return this.internalSchema.metadata.required||this.internalSchema.metadata.maxlength||this.internalSchema.metadata.minlength||this.internalSchema.metadata.pattern||this.internalSchema.metadata.min||this.internalSchema.metadata.max},revalidate:async function(){let e=await new w().validate(document.getElementById(this.getFieldID()));return this.errorMessage=e.errorMessage,e.isValid},getFieldID:function(){let e="";return this.schema.id?e=this.schema.id:e=this.schema.model.slugify(),this.idSuffix!==void 0&&(e+=this.idSuffix),e},changed:function(e){this.revalidate();let n=this;n.filesAdded=n.filesAdded+e.target.files.length,n.ready=!1;for(let a=0;a<e.target.files.length;++a){let r=new FileReader;r.onload=function(i){return function(s){n.files=n.files.concat({filename:i,data:n.base64ArrayBuffer(r.result)}),n.files.length===n.filesAdded&&(n.ready=!0)}}(e.target.files[a].name),r.readAsArrayBuffer(e.target.files[a])}this.check()},base64ArrayBuffer:function(e){let n="",a=new Uint8Array(e),r=a.byteLength;for(let i=0;i<r;++i)n+=String.fromCharCode(a[i]);return window.btoa(n)},check:function(){if(this.ready===!0){this.$emit("changed",this.files,this.schema);return}setTimeout(this.check,100)},removeFile:function(e){let n=this.files.indexOf(e);this.files.splice(n,1),this.filesAdded--},generateGuid:function(e){let n=e.key;if(n)return n;let a="";for(let r=0;r<32;r++){let i=Math.floor(Math.random()*16).toString(16).toUpperCase();a=a+i}return e.key=a,e.key}},watch:{model:function(e,n){n!==e&&(this.internalModel=e,this.$nextTick(function(){this.revalidate()}))}},mounted:function(){this.$nextTick(function(){this.revalidate()})}}),yt=["for"],kt={key:0,class:"error clear-background"},St={key:1,class:"clear-background active no-border small"},bt=t.createElementVNode("span",{class:"fas fa-info-circle"},null,-1),Et={key:2,class:"error clear-background"},$t={key:3,class:"success clear-background fas fa-check-circle"},vt=["for"],wt={key:0,class:"error clear-background"},Bt={key:1,class:"clear-background active no-border small"},Nt=t.createElementVNode("span",{class:"fas fa-info-circle"},null,-1),Ct={key:2,class:"error clear-background"},Mt={key:3,class:"success clear-background fas fa-check-circle"},Dt={key:2},Tt=["accept","id","multiple","name","required","data-error-message-value-missing"],Ft={key:3,class:"flex"},qt=["onClick"],It={class:"body"};function jt(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",null,[t.createTextVNode(" Upload "),e.schema.label?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock("label",{key:0,for:e.getFieldID(),class:t.normalizeClass(e.schema.labelClasses)},[t.createTextVNode(t.toDisplayString(e.$filters.capitalize(e.schema.model))+" ",1),e.schema.required&&e.errorMessage?(t.openBlock(),t.createElementBlock("span",kt,"*")):t.createCommentVNode("",!0),e.schema.hint?(t.openBlock(),t.createElementBlock("i",St,[bt,t.createTextVNode(t.toDisplayString(e.schema.hint),1)])):t.createCommentVNode("",!0),e.errorMessage?(t.openBlock(),t.createElementBlock("span",Et,t.toDisplayString(e.errorMessage),1)):t.createCommentVNode("",!0),!e.errorMessage&&e.willValidate()?(t.openBlock(),t.createElementBlock("span",$t)):t.createCommentVNode("",!0)],10,yt)),e.schema.label?(t.openBlock(),t.createElementBlock("label",{key:1,for:e.getFieldID(),class:t.normalizeClass(e.schema.labelClasses)},[t.createTextVNode(t.toDisplayString(e.schema.label)+" ",1),e.schema.required&&e.errorMessage?(t.openBlock(),t.createElementBlock("span",wt,"*")):t.createCommentVNode("",!0),e.schema.hint?(t.openBlock(),t.createElementBlock("i",Bt,[Nt,t.createTextVNode(t.toDisplayString(e.schema.hint),1)])):t.createCommentVNode("",!0),e.errorMessage?(t.openBlock(),t.createElementBlock("span",Ct,t.toDisplayString(e.errorMessage),1)):t.createCommentVNode("",!0),!e.errorMessage&&e.willValidate()?(t.openBlock(),t.createElementBlock("span",Mt)):t.createCommentVNode("",!0)],10,vt)):t.createCommentVNode("",!0),e.internalSchema.metadata.subtitle?(t.openBlock(),t.createElementBlock("div",Dt,t.toDisplayString(e.internalSchema.metadata.subtitle),1)):t.createCommentVNode("",!0),t.createElementVNode("div",{class:t.normalizeClass(["file-upload",e.schema.inputClasses])},[t.createTextVNode(t.toDisplayString(e.schema.placeholder)+" ",1),t.createElementVNode("input",{accept:e.schema.accept,id:e.getFieldID(),onChange:n[0]||(n[0]=o=>e.changed(o)),multiple:e.schema.multiple,name:e.schema.inputName||e.getFieldID(),required:e.schema.required,type:"file","data-error-message-value-missing":e.schema.errorMessageValueMissing},null,40,Tt)],2),e.schema.uploadPreview?(t.openBlock(),t.createElementBlock("div",Ft,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.files,o=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["upload-preview panel",e.schema.previewClasses]),key:e.generateGuid(o)},[t.createElementVNode("header",null,[t.createElementVNode("div",{class:"header",onClick:l=>e.removeFile(o)},"×",8,qt),t.createTextVNode(" ")]),t.createElementVNode("div",It,t.toDisplayString(o.filename),1)],2))),128))])):t.createCommentVNode("",!0)])}const Y=h(gt,[["render",jt]]),At=t.defineComponent({data:function(){return{internalModel:this.model}},props:{model:Object,schema:Object,idSuffix:String},methods:{click:function(e,n){return this.$emit("click",e,n),!1},generateGuid:function(e){let n=e.key;if(n)return n;let a="";for(let r=0;r<32;r++){let i=Math.floor(Math.random()*16).toString(16).toUpperCase();a=a+i}return e.key=a,e.key}},watch:{model:function(e,n){n!==e&&(this.internalModel=e)}}}),Lt={class:"controls"},Ot={class:"input-group"},Pt=["type","value","onClick"];function zt(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",Lt,[t.createTextVNode(" Buttons "),t.createElementVNode("div",Ot,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.schema.buttons,o=>(t.openBlock(),t.createElementBlock("input",{key:e.generateGuid(o),type:o.type,value:o.value,class:t.normalizeClass(o.classes),onClick:l=>e.click(l,o)},null,10,Pt))),128))])])}const K=h(At,[["render",zt]]),Rt=t.defineComponent({data:function(){return{internalModel:this.model}},props:{model:Object,schema:Object,idSuffix:String},methods:{show:function(e){return typeof e=="function"?e():e},getFieldType:function(e){return e.type.indexOf("form-field-")==0?e.type:"form-field-"+e.type},getModelValue:function(e){return this.internalModel[e.model]},error:function(e){this.$emit("error",e)},exception:function(e){this.$emit("exception",e)},setModelValue:function(e,n){this.internalModel[n.model]=e,this.$emit("changed",this.internalModel,this.schema)},buttonClicked:function(e,n){this.$emit("click",e,n)},getSchema:function(e){return e.type.startsWith("complex")?(e.schema.model===void 0&&(e.schema.model=e.model),e.schema):e},getIDSuffix:function(e){return this.idSuffix===void 0?"":this.idSuffix},generateGuid:function(e){let n=e.key;if(n)return n;let a="";for(let r=0;r<32;r++){let i=Math.floor(Math.random()*16).toString(16).toUpperCase();a=a+i}return e.key=a,e.key}},watch:{model:function(e,n){n!==e&&(this.internalModel=e)}}}),_t={key:0};function Ut(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",null,[t.createTextVNode(" Conditional "),e.show(e.internalModel.display||e.schema.display)?(t.openBlock(),t.createElementBlock("div",_t,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.schema.fields,o=>(t.openBlock(),t.createElementBlock("div",{key:e.generateGuid(o)},[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.getFieldType(o)),{schema:e.getSchema(o),model:e.getModelValue(o),"id-suffix":e.getIDSuffix(o),onChanged:e.setModelValue,onClick:e.buttonClicked,onError:e.error,onException:e.exception},null,40,["schema","model","id-suffix","onChanged","onClick","onError","onException"]))]))),128))])):t.createCommentVNode("",!0)])}const Yt=h(Rt,[["render",Ut]]),Kt=t.defineComponent({name:"form-field-complex-list",components:{"form-field-input":O,"form-field-select":P,"form-field-checkbox":z,"form-field-radio":R,"form-field-text-area":_,"form-field-text":U,"form-field-upload":Y,"form-field-buttons":K},data:function(){return{internalModel:this.model,internalSchema:this.schema,defaultItem:this.getDefaultValue(this.schema)}},props:{model:{type:Object,default:{}},schema:{type:Object,default:{fields:[]}}},methods:{getDefaultValue(e){if(e==null)return{};let n={};for(let a=0;a<e.metadata.fields.length;++a){let r=e.metadata.fields[a];if(r.propertyType.indexOf("complex")==-1)if(r.metadata.inputType==="date"||r.metadata.inputType==="datetime-local"||r.metadata.inputType==="datetime"||r.metadata.inputType==="month"){let i=moment(new Date);r.isUTC&&(i=moment.utc(new Date).local()),r.inputType==="date"?n[r.propertyName]=i.format("YYYY-MM-DD"):r.inputType==="datetime-local"||r.inputType==="datetime"?n[r.propertyName]=i.format("YYYY-MM-DDTHH:mm"):r.inputType==="month"&&(n[r.propertyName]=i.format("YYYY-MM"))}else n[r.propertyName]="";else r.propertyType.indexOf("complex-list")>-1||r.propertyType.indexOf("complex-repeater")>-1?n[r.propertyName]=[]:n[r.propertyName]=this.getDefaultValue(r)}return n},getFieldType:function(e){return"form-field-"+e.propertyType},getModelValue:function(e,n){return n[e.propertyName]},setModelValue:function(e,n,a){n[e.propertyName]=a,this.$emit("changed",this.internalModel,this.schema)},error:function(e){this.$emit("error",e)},exception:function(e){this.$emit("exception",e)},buttonClicked:function(e,n){this.$emit("click",e,n)},removeItem:function(e){if(this.internalSchema.confirmRemoval&&!confirm("Are you sure you want to remove this item?"))return;this.internalModel||(this.internalModel=[]);let n=this.internalModel.indexOf(e);this.internalModel.splice(n,1),this.$emit("changed",this.internalModel,this.internalSchema)},addItem:function(){this.internalModel||(this.internalModel=[]),this.internalModel=this.internalModel.concat(Object.assign({},this.defaultItem)),this.$emit("changed",this.internalModel,this.schema)},generateGuid:function(e){let n=e.key;if(n)return n;let a="";for(let r=0;r<32;r++){let i=Math.floor(Math.random()*16).toString(16).toUpperCase();a=a+i}return e.key=a,e.key}},watch:{model:function(e,n){n!==e&&(this.internalModel=e)},schema:function(e,n){n!==e&&(this.internalSchema=e)}}}),Gt={key:0},Ht={class:"form-table"},Qt=["data-tooltip"],Jt=[t.createElementVNode("span",{class:"fas fa-info-circle no-border small"},null,-1)],Wt=t.createElementVNode("th",null,null,-1),Zt=["onClick"],Xt=["colspan"],xt=t.createElementVNode("span",{class:"fas fa-plus-circle"},null,-1);function Vt(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",null,[e.internalSchema.displayName?(t.openBlock(),t.createElementBlock("h2",Gt,t.toDisplayString(e.$filters.capitalize(e.internalSchema.displayName)),1)):t.createCommentVNode("",!0),t.createElementVNode("table",Ht,[t.createElementVNode("thead",null,[t.createElementVNode("tr",null,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.internalSchema.metadata.fields,o=>(t.openBlock(),t.createElementBlock("th",{key:e.generateGuid(o)},[t.createTextVNode(t.toDisplayString(e.$filters.capitalize(o.displayName))+" ",1),o.metadata.hint?(t.openBlock(),t.createElementBlock("span",{key:0,"data-tooltip":o.metadata.hint,"data-tooltip-size":"extra-large"},Jt,8,Qt)):t.createCommentVNode("",!0)]))),128)),Wt])]),t.createElementVNode("tbody",null,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.internalModel,(o,l)=>(t.openBlock(),t.createElementBlock("tr",{key:e.generateGuid(o)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.internalSchema.metadata.fields,c=>(t.openBlock(),t.createElementBlock("td",{key:e.generateGuid(c)},[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.getFieldType(c)),{schema:c,model:e.getModelValue(c,o),label:!1,onChanged:m=>e.setModelValue(c,o,m),onClick:e.buttonClicked,onError:e.error,onException:e.exception},null,40,["schema","model","onChanged","onClick","onError","onException"]))]))),128)),t.createElementVNode("td",null,[t.createElementVNode("a",{class:"fas fa-minus-circle",onClick:t.withModifiers(c=>e.removeItem(o),["stop","prevent"])},null,8,Zt)])]))),128))]),t.createElementVNode("tfoot",null,[t.createElementVNode("tr",null,[t.createElementVNode("td",{colspan:e.internalSchema.metadata.fields.length+1},[t.createElementVNode("a",{onClick:n[0]||(n[0]=t.withModifiers((...o)=>e.addItem&&e.addItem(...o),["stop","prevent"]))},[xt,t.createTextVNode("Add More")])],8,Xt)])])])])}const en=h(Kt,[["render",Vt]]),tn=t.defineComponent({methods:{findTab:function(e){return!this.sections||this.sections.length===0?null:(e||(e=this.sections[0].name),this.sections.filter(n=>n.name===e)[0])},switchSelected:function(e){this.sectionPicked=this.findTab(e),this.switchTabs(),this.$emit("section-changed",this.sectionPicked)},switchTabs:function(){if(!(!this.sections||this.sections.length===0)&&(this.sections.some(e=>e===this.sectionPicked)||(this.sectionPicked=this.sections[0]),!!this.sectionPicked)){for(let e=0;e<this.sections.length;++e)this.sections[e].selected=!1;this.sectionPicked.selected=!0}}},props:{initialSectionPicked:{type:String,default:""},sections:{type:Array,default:[]}},watch:{sections:function(e){var n;this.switchSelected((n=this.sectionPicked)==null?void 0:n.name)},initialSectionPicked:function(e){this.switchSelected(this.initialSectionPicked)}},data(){return{sectionPicked:this.findTab(this.initialSectionPicked)}},beforeMount:function(){this.switchSelected(this.initialSectionPicked)}}),nn={class:"tabs"},an={class:"row flex align-items-stretch"},rn=["onClick"];function on(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",nn,[t.createElementVNode("header",null,[t.createElementVNode("ul",an,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.sections,(o,l)=>(t.openBlock(),t.createElementBlock("li",{key:l},[t.createElementVNode("a",{href:"#!",onClick:t.withModifiers(c=>e.switchSelected(o.name),["stop","prevent"]),class:t.normalizeClass(["tab",{selected:o.selected}])},[t.createElementVNode("span",{class:t.normalizeClass(["fas",[o.icon]])},null,2),t.createTextVNode(" "+t.toDisplayString(o.name),1)],10,rn)]))),128))])]),t.createElementVNode("section",null,[t.renderSlot(e.$slots,"default")])])}const sn=h(tn,[["render",on]]),ln=t.defineComponent({components:{tabs:sn},data(){return{internalModel:this.model,tabPicked:this.schema.tabs[0]}},props:{model:Object,schema:Object,idSuffix:String},methods:{getFieldType:function(e){return e.type.indexOf("form-field-")==0?e.type:"form-field-"+e.type},getModelValue:function(e){return this.internalModel[this.tabPicked.model][e.model]},setModelValue:function(e,n){this.internalModel[this.tabPicked.model][n.model]=e,this.$emit("changed",this.internalModel,this.schema)},error:function(e){this.$emit("error",e)},exception:function(e){this.$emit("exception",e)},buttonClicked:function(e,n){this.$emit("click",e,n)},getSchema:function(e){return e},tabChanged:function(e){this.tabPicked=e},getFields:function(){return this.tabPicked.fields},getIDSuffix:function(e){return this.idSuffix===void 0?"":this.idSuffix},generateGuid:function(e){let n=e.key;if(n)return n;let a="";for(let r=0;r<32;r++){let i=Math.floor(Math.random()*16).toString(16).toUpperCase();a=a+i}return e.key=a,e.key}},watch:{model:function(e,n){n!==e&&(this.internalModel=e)}}});function cn(e,n,a,r,i,s){const o=t.resolveComponent("tabs");return t.openBlock(),t.createElementBlock("div",null,[t.createTextVNode(" Complex Tabs "),t.createVNode(o,{sections:e.schema.tabs,onSectionChanged:e.tabChanged,class:t.normalizeClass(e.schema.tabClasses)},{default:t.withCtx(()=>[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.getFields(),l=>(t.openBlock(),t.createElementBlock("div",{key:e.generateGuid(l)},[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.getFieldType(l)),{schema:e.getSchema(l),model:e.getModelValue(l),"id-suffix":e.getIDSuffix(l),onChanged:e.setModelValue,onClick:e.buttonClicked,onError:e.error,onException:e.exception},null,40,["schema","model","id-suffix","onChanged","onClick","onError","onException"]))]))),128))]),_:1},8,["sections","onSectionChanged","class"])])}const dn=h(ln,[["render",cn]]),mn=t.defineComponent({data:function(){let e={};for(let n in this.model[0])this.model[0].hasOwnProperty(n)&&(e[n]="");return{internalModel:this.model,defaultItem:e}},props:{model:Object,schema:Object,idSuffix:String},methods:{getFieldType:function(e){return e.type.indexOf("form-field-")==0?e.type:"form-field-"+e.type},getModelValue:function(e,n){return n[e.model]},setModelValue:function(e,n,a){n[e.model]=a,this.$emit("changed",this.internalModel,this.schema)},error:function(e){this.$emit("error",e)},exception:function(e){this.$emit("exception",e)},buttonClicked:function(e,n){this.$emit("click",e,n)},getSchema:function(e){return e},removeItem:function(e){if(this.schema.confirmRemoval&&!confirm("Are you sure you want to remove this item?"))return;this.internalModel||(this.internalModel=[]);let n=this.internalModel.indexOf(e);this.internalModel.splice(n,1),this.$emit("changed",this.internalModel,this.schema)},addItem:function(e){this.internalModel||(this.internalModel=[]),this.internalModel=this.internalModel.concat(Object.assign({},this.defaultItem)),this.$emit("changed",this.internalModel,this.schema)},getIDSuffix:function(e,n){return this.idSuffix===void 0?n:this.idSuffix+n},generateGuid:function(e){let n=e.key;if(n)return n;let a="";for(let r=0;r<32;r++){let i=Math.floor(Math.random()*16).toString(16).toUpperCase();a=a+i}return e.key=a,e.key}},watch:{model:function(e,n){n!==e&&(this.internalModel=e)}}}),hn=["onClick"],pn=t.createElementVNode("span",{class:"fas fa-plus-circle"},null,-1);function fn(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",null,[t.createTextVNode(" Complex Repeater "),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.internalModel,(o,l)=>(t.openBlock(),t.createElementBlock("div",{key:e.generateGuid(o),class:"border-bottom"},[t.createElementVNode("a",{class:"fas fa-minus-circle right",onClick:t.withModifiers(c=>e.removeItem(o),["stop","prevent"])},null,8,hn),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.schema.fields,c=>(t.openBlock(),t.createElementBlock("div",{key:e.generateGuid(c)},[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.getFieldType(c)),{schema:e.getSchema(c),model:e.getModelValue(c,o),label:!0,"id-suffix":e.getIDSuffix(c,l),onChanged:m=>e.setModelValue(c,o,m),onClick:e.buttonClicked,onError:e.error,onException:e.exception},null,40,["schema","model","id-suffix","onChanged","onClick","onError","onException"]))]))),128))]))),128)),t.createElementVNode("a",{onClick:n[0]||(n[0]=t.withModifiers((...o)=>e.addItem&&e.addItem(...o),["stop","prevent"]))},[pn,t.createTextVNode("Add More")])])}const un=h(mn,[["render",fn]]),gn=t.defineComponent({name:"form-field-complex",components:{"form-field-complex-conditional":Yt,"form-field-complex-list":en,"form-field-complex-tabs":dn,"form-field-input":O,"form-field-select":P,"form-field-checkbox":z,"form-field-radio":R,"form-field-text-area":_,"form-field-text":U,"form-field-upload":Y,"form-field-buttons":K,"form-field-complex-repeater":un},data:function(){return{internalModel:this.model,internalSchema:this.schema}},props:{model:{type:Object,default:{}},schema:{type:Object,default:{fields:[]}}},methods:{error:function(e){this.$emit("error",e)},exception:function(e){this.$emit("exception",e)},setModelValue:function(e,n){this.internalModel[n.propertyName]=e,this.$emit("changed",this.internalModel,this.schema)},buttonClicked:function(e,n){this.$emit("click",e,n)},generateGuid:function(e){let n=e.key;if(n)return n;let a="";for(let r=0;r<32;r++){let i=Math.floor(Math.random()*16).toString(16).toUpperCase();a=a+i}return e.key=a,e.key}},watch:{model:function(e,n){n!==e&&(this.internalModel=e)},schema:function(e,n){n!==e&&(this.internalSchema=e)}}});function yn(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",null,[e.internalModel?(t.openBlock(!0),t.createElementBlock(t.Fragment,{key:0},t.renderList(e.internalSchema.fields,o=>(t.openBlock(),t.createElementBlock("div",{key:e.generateGuid(o)},[(t.openBlock(),t.createBlock(t.resolveDynamicComponent("form-field-"+o.propertyType),{schema:o,model:e.internalModel[o.propertyName],onChanged:e.setModelValue,onClick:e.buttonClicked,onError:e.error,onException:e.exception},null,40,["schema","model","onChanged","onClick","onError","onException"]))]))),128)):t.createCommentVNode("",!0)])}const kn=h(gn,[["render",yn]]),Sn=t.defineComponent({name:"mithril-form",components:{"form-field-complex":kn},data:function(){return{submitting:!1,internalModel:JSON.parse(JSON.stringify(this.model)),internalSchema:{fields:this.schema},formID:"mithril-form-"+Math.floor(Math.random()*1e9),valid:!1}},props:{schema:{type:Array,default:[]},model:{type:Object,default:{}},action:{default:"",type:String},ajaxAction:{default:"",type:String},encoding:{default:"multipart/form-data",type:String},debug:{default:!0,type:Boolean}},methods:{revalidate:async function(){return this.valid=await ae.validateForm(document.getElementById(this.formID)),this.valid},setModelValue:function(e,n){this.internalModel=e,this.revalidate(),this.$emit("changed",this.internalModel)},error:function(e){this.$emit("error",e)},exception:function(e){this.$emit("exception",e)},buttonClicked:function(e,n){this.revalidate(),this.$emit("click",e,n)},reset:function(){let e=this;d.debug("Resetting form to state:",e.model),e.internalModel=JSON.parse(JSON.stringify(e.model)),setTimeout(function(){e.revalidate()},100)},submit:function(e){let n=this;return!n.revalidate()||n.submitting?(e.preventDefault(),!1):(n.submitting=!0,n.ajaxAction?(d.debug("Submitting form to location: ",{location:n.ajaxAction}),p.post(n.ajaxAction,n.internalModel).onSuccess(function(a){n.submitting=!1,n.$emit("success",a)}).onError(function(a){n.submitting=!1,n.$emit("error",a)}).send(),e.preventDefault(),!1):(this.$emit("submit",e,n.internalModel),e.preventDefault(),!1))},getIDSuffix:function(){return""}},watch:{schema:function(e,n){n!==e&&(this.internalSchema=e,this.internalModel!==null&&this.$nextTick(()=>{this.revalidate()}))},model:function(e,n){n!==e&&(this.internalModel=e,e!==null&&this.$nextTick(()=>{this.revalidate()}))}},mounted:function(){this.$nextTick(function(){this.revalidate()})}}),Ka="",N=e=>(t.pushScopeId("data-v-c5bd6270"),e=e(),t.popScopeId(),e),bn=["action","enctype","id"],En={key:0,class:"panel error"},$n=[N(()=>t.createElementVNode("header",null,"Oops, some form elements have problems",-1)),N(()=>t.createElementVNode("div",{class:"body"}," We're sorry but some of the fields are having issues. ",-1))],vn={class:"input-group"},wn=["disabled","value"],Bn=["disabled"],Nn={key:1,class:"flex row no-wrap"},Cn={class:"panel"},Mn=N(()=>t.createElementVNode("header",null,"Form Schema",-1)),Dn={class:"body"},Tn={class:"panel"},Fn=N(()=>t.createElementVNode("header",null,"Form Model",-1)),qn={class:"body"};function In(e,n,a,r,i,s){const o=t.resolveComponent("form-field-complex");return t.openBlock(),t.createElementBlock("form",{action:e.action,class:"stacked",onReset:n[0]||(n[0]=t.withModifiers((...l)=>e.reset&&e.reset(...l),["stop","prevent"])),onSubmit:n[1]||(n[1]=(...l)=>e.submit&&e.submit(...l)),method:"post",enctype:e.encoding,id:e.formID},[e.valid?t.createCommentVNode("",!0):(t.openBlock(),t.createElementBlock("div",En,$n)),t.createVNode(o,{schema:e.internalSchema,model:e.internalModel,onChanged:e.setModelValue,onClick:e.buttonClicked,onError:e.error,onException:e.exception},null,8,["schema","model","onChanged","onClick","onError","onException"]),t.createElementVNode("div",null,[t.createElementVNode("div",vn,[t.createElementVNode("input",{type:"submit",disabled:e.submitting,value:e.submitting?"Submitting...":"Submit"},null,8,wn),t.createElementVNode("input",{type:"reset",disabled:e.submitting,value:"Reset"},null,8,Bn)])]),e.debug?(t.openBlock(),t.createElementBlock("div",Nn,[t.createElementVNode("div",Cn,[Mn,t.createElementVNode("div",Dn,[t.createElementVNode("pre",null,"                        "+t.toDisplayString(e.internalSchema)+`
                    `,1)])]),t.createElementVNode("div",Tn,[Fn,t.createElementVNode("div",qn,[t.createElementVNode("pre",null,"                        "+t.toDisplayString(e.internalModel)+`
                    `,1)])])])):t.createCommentVNode("",!0)],40,bn)}const G=h(Sn,[["render",In],["__scopeId","data-v-c5bd6270"]]),jn=t.defineComponent({name:"settings-editor-component",components:{"mithril-form":G},data:function(){return{currentEntity:null,entityQuery:`query($entityType: String) {
                    entity(entityType: $entityType)
                }`}},methods:{close:function(){this.$emit("close")},loadData:B(async function(){let e=this;await p.post("/api/query",{query:e.entityQuery,variables:{entityType:e.schema.dataType}}).onSuccess(a=>{d.debug("Entity loaded successfully",a.data.entity),e.currentEntity=a.data.entity}).send()},100),saveEntity:function(e,n){let a=this;if(e.preventDefault(),n!=null)return this.currentEntity=null,d.debug(n),p.post("/api/command/v1/SaveModelCommand",{data:n,entityType:a.schema.dataType,id:n.iD}).onSuccess(r=>{d.debug("Entity saved successfully",r.data),a.close()}).onError(r=>{d.error("Error saving entity",r.data)}).send(),!1}},props:{name:{type:String,default:""},schema:{type:Object,default:{}},debug:{type:Boolean,default:!0}},created:function(){this.loadData()},watch:{schema:function(){this.loadData()}}}),An={class:"body"},Ln={key:0,class:"panel debug"},On=t.createElementVNode("header",null,"Editor Schema",-1);function Pn(e,n,a,r,i,s){const o=t.resolveComponent("mithril-form");return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["panel",e.schema.class])},[t.createElementVNode("header",null,t.toDisplayString(e.name),1),t.createElementVNode("div",An,[t.createElementVNode("div",null,[t.createVNode(o,{schema:e.schema.modelSchema,model:e.currentEntity,debug:e.debug,onSubmit:e.saveEntity},null,8,["schema","model","debug","onSubmit"])]),e.debug&&e.schema?(t.openBlock(),t.createElementBlock("div",Ln,[On,t.createElementVNode("pre",null,""+t.toDisplayString(e.schema)+`
            `,1)])):t.createCommentVNode("",!0)])],2)}const zn=h(jn,[["render",Pn]]);class H{constructor(n,a,r,i,s){this.filter=n,this.pageSize=a,this.page=r,this.sortField=i,this.sortAscending=s}}const Rn=t.defineComponent({name:"mithril-listing",data:function(){return{internalModel:this.model,internalSchema:this.schema.filter(e=>{var n;return((n=e.metadata)==null?void 0:n.canList)??!0}),filter:"",pageSize:10,page:0,sortField:"",sortAscending:!1}},props:{model:{type:Object,default:{}},schema:{type:Array,default:[]},debug:{type:Boolean,default:!1}},methods:{filterData:B(function(e){let n=this;n.$emit("filter",e,new H(n.filter,n.pageSize,n.page,n.sortField,n.sortAscending))},300),entitySelected:function(e){this.$emit("entity-selected",e)}},watch:{model:function(e,n){n!==e&&(this.internalModel=e)},schema:function(e,n){n!==e&&(this.internalSchema=e.filter(a=>{var r;return((r=a.metadata)==null?void 0:r.canList)??!0}))}}}),Qa="",T=e=>(t.pushScopeId("data-v-f557b045"),e=e(),t.popScopeId(),e),_n={class:"flex row"},Un={class:"right"},Yn=[t.createStaticVNode('<option value="10" data-v-f557b045>10</option><option value="25" data-v-f557b045>25</option><option value="50" data-v-f557b045>50</option><option value="100" data-v-f557b045>100</option><option value="-1" data-v-f557b045>All</option>',5)],Kn=T(()=>t.createElementVNode("br",{class:"clear"},null,-1)),Gn=["onClick"],Hn={key:0,class:"flex row"},Qn={class:"panel"},Jn=T(()=>t.createElementVNode("header",null,"Listing Schema",-1)),Wn={class:"body"},Zn={class:"panel"},Xn=T(()=>t.createElementVNode("header",null,"Listing Model",-1)),xn={class:"body"};function Vn(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",null,[t.createElementVNode("div",_n,[t.withDirectives(t.createElementVNode("input",{type:"text",placeholder:"Find an item",onKeyup:n[0]||(n[0]=(...o)=>e.filterData&&e.filterData(...o)),"onUpdate:modelValue":n[1]||(n[1]=o=>e.filter=o)},null,544),[[t.vModelText,e.filter]]),t.createElementVNode("div",null,[t.createElementVNode("label",Un,[t.createTextVNode(" Show "),t.withDirectives(t.createElementVNode("select",{"onUpdate:modelValue":n[2]||(n[2]=o=>e.pageSize=o),onChange:n[3]||(n[3]=(...o)=>e.filterData&&e.filterData(...o))},Yn,544),[[t.vModelSelect,e.pageSize]]),t.createTextVNode(" Records ")])])]),Kn,t.createElementVNode("table",null,[t.createElementVNode("thead",null,[t.createElementVNode("tr",null,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.internalSchema,o=>(t.openBlock(),t.createElementBlock("th",{key:o.propertyName},t.toDisplayString(o.displayName),1))),128))])]),t.createElementVNode("tbody",null,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.internalModel,o=>(t.openBlock(),t.createElementBlock("tr",{key:o.id},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.internalSchema,l=>(t.openBlock(),t.createElementBlock("td",{key:l.propertyName},[t.createElementVNode("a",{onClick:c=>e.entitySelected(o)},t.toDisplayString(o[l.propertyName]),9,Gn)]))),128))]))),128))])]),e.debug?(t.openBlock(),t.createElementBlock("div",Hn,[t.createElementVNode("div",Qn,[Jn,t.createElementVNode("div",Wn,[t.createElementVNode("pre",null,"                        "+t.toDisplayString(e.internalSchema)+`
                    `,1)])]),t.createElementVNode("div",Zn,[Xn,t.createElementVNode("div",xn,[t.createElementVNode("pre",null,"                        "+t.toDisplayString(e.internalModel)+`
                    `,1)])])])):t.createCommentVNode("",!0)])}const ea=h(Rn,[["render",Vn],["__scopeId","data-v-f557b045"]]),ta=t.defineComponent({name:"data-editor-component",components:{listing:ea,"mithril-form":G},data:function(){return{entities:[],mode:"listing",currentEntity:null,entitiesQuery:`query($entityType: String, $pageSize: Int, $page: Int, $sortField: String, $sortAscending: Boolean, $filter: String) {
                    entities(entityType: $entityType, pageSize: $pageSize, page: $page, sortField: $sortField, sortAscending: $sortAscending, filter: $filter)
                }`,currentFilter:new H("",10,0,"",!1),currentRequest:null,entityQuery:`query($entityType: String, $id: Long) {
                    entity(entityType: $entityType, id: $id)
                }`}},methods:{editEntity:async function(e){let n=this;d.debug("Editing entity",e),await p.post("/api/query",{query:n.entityQuery,variables:{entityType:n.schema.dataType,id:e.iD}}).onSuccess(r=>{d.debug("Entity loaded successfully",r.data.entity),n.currentEntity=r.data.entity,this.mode="editor"}).send()},filter:function(e,n){this.currentFilter=n,this.loadData()},loadData:B(async function(){let e=this;e.currentRequest!=null&&(e.cancellationToken.canceled=!0),e.cancellationToken=new te,e.currentRequest=p.post("/api/query",{query:e.entitiesQuery,variables:{entityType:e.schema.dataType,pageSize:Number.parseInt(e.currentFilter.pageSize),page:Number.parseInt(e.currentFilter.page),sortField:e.currentFilter.sortField,sortAscending:e.currentFilter.sortAscending,filter:e.currentFilter.filter}}).withCancellationToken(e.cancellationToken).onSuccess(n=>{d.debug("Entities loaded successfully",n.data.entities),e.entities=n.data.entities}),await e.currentRequest.send()},100),openListing:function(){d.debug("Opening listing"),this.mode="listing",this.loadData()},saveEntity:function(e,n){let a=this;if(e.preventDefault(),n!=null)return this.currentEntity=null,d.debug("Saving entity:",n),p.post("/api/command/v1/SaveModelCommand",{data:n,entityType:a.schema.dataType,id:n.iD}).onSuccess(r=>{d.debug("Entity saved successfully",r.data),a.mode="listing",a.loadData()}).onError(r=>d.error("Error saving entity",r)).send(),!1}},props:{name:{type:String,default:""},schema:{type:Object,default:{}},debug:{type:Boolean,default:!0}},created:function(){this.openListing(),this.loadData()},watch:{schema:function(){this.openListing(),this.loadData()}}}),Wa="",F=e=>(t.pushScopeId("data-v-c4c98bca"),e=e(),t.popScopeId(),e),na=["title"],aa=[F(()=>t.createElementVNode("span",{class:"fas fa-plus right"},null,-1))],ra=[F(()=>t.createElementVNode("span",{class:"fas fa-list right"},null,-1))],oa={class:"body"},ia={key:0},sa={key:1},la={key:2,class:"panel debug"},ca=F(()=>t.createElementVNode("header",null,"Editor Schema",-1));function da(e,n,a,r,i,s){const o=t.resolveComponent("listing"),l=t.resolveComponent("mithril-form");return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["panel",e.schema.class])},[t.createElementVNode("header",null,[t.createTextVNode(t.toDisplayString(e.name)+" ",1),e.mode=="listing"?(t.openBlock(),t.createElementBlock("a",{key:0,onClick:n[0]||(n[0]=c=>e.editEntity({iD:0})),title:"Add New "+e.name},aa,8,na)):t.createCommentVNode("",!0),e.mode=="editor"?(t.openBlock(),t.createElementBlock("a",{key:1,onClick:n[1]||(n[1]=(...c)=>e.openListing&&e.openListing(...c)),title:"Show Listing"},ra)):t.createCommentVNode("",!0)]),t.createElementVNode("div",oa,[e.mode=="listing"?(t.openBlock(),t.createElementBlock("div",ia,[t.createVNode(o,{schema:e.schema.modelSchema,model:e.entities,debug:e.debug,onEntitySelected:e.editEntity,onFilter:e.filter},null,8,["schema","model","debug","onEntitySelected","onFilter"])])):t.createCommentVNode("",!0),e.mode=="editor"?(t.openBlock(),t.createElementBlock("div",sa,[t.createVNode(l,{schema:e.schema.modelSchema,model:e.currentEntity,debug:e.debug,onSubmit:e.saveEntity},null,8,["schema","model","debug","onSubmit"])])):t.createCommentVNode("",!0),e.debug&&e.schema?(t.openBlock(),t.createElementBlock("div",la,[ca,t.createElementVNode("pre",null,""+t.toDisplayString(e.schema)+`
                `,1)])):t.createCommentVNode("",!0)])],2)}const ma=h(ta,[["render",da],["__scopeId","data-v-c4c98bca"]]),ha=t.defineComponent({name:"admin-application",computed:{groupedEditors:function(){const e={};return this.sortedEditors.forEach(n=>{e[n.category]||(e[n.category]=[]),e[n.category].push(n)}),Object.keys(e).map(n=>({category:n,editors:e[n]}))},sortedEditors:function(){return this.editors.sort((e,n)=>e.category<n.category?-1:e.category>n.category?1:e.name<n.name?-1:e.name>n.name?1:0)}},data:function(){return{editors:[],currentEditor:null}},methods:{close:function(){this.editorSelected(null)},editorSelected:function(e){this.debug&&d.debug("Switching to editor:",(e==null?void 0:e.name)??""),this.currentEditor=e},loadEditors:function(){this.debug&&d.debug("Loading Editors");let e=this;p.post("/api/query",{query:`query{
  editors {
    category
    componentDefinition {
      name
      schema
      scriptFile
    }
    description
    icon
    name
  }
}`}).onSuccess(n=>{e.editors=n.data.editors,e.debug&&d.debug("Finished loading editors:",n.data.editors)}).withStorageMode($.StorageAndUpdate).send()}},props:{debug:{type:Boolean,default:!0}},created:function(){this.loadEditors()}}),xa="",pa=e=>(t.pushScopeId("data-v-280d2014"),e=e(),t.popScopeId(),e),fa={class:"main-application"},ua={class:"left-nav panel"},ga={class:"menu"},ya=["onClick","title"],ka={class:"editor-content"},Sa={key:1,class:"panel debug"},ba=pa(()=>t.createElementVNode("header",null,"Selected Editor Info",-1));function Ea(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",fa,[t.createElementVNode("div",ua,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.groupedEditors,o=>(t.openBlock(),t.createElementBlock("section",{key:o.category},[t.createElementVNode("header",null,t.toDisplayString(e.$filters.capitalize(o.category)),1),t.createElementVNode("ul",ga,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(o.editors,(l,c)=>(t.openBlock(),t.createElementBlock("li",{key:l.name},[t.createElementVNode("a",{href:"#!",onClick:t.withModifiers(m=>e.editorSelected(l),["stop","prevent"]),title:l.description,class:t.normalizeClass({selected:e.currentEditor==l})},[t.createElementVNode("span",{class:t.normalizeClass(l.icon)},null,2),t.createTextVNode(t.toDisplayString(l.name),1)],10,ya)]))),128))])]))),128))]),t.createElementVNode("div",ka,[e.currentEditor?(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.currentEditor.componentDefinition.schema.type),{key:0,schema:e.currentEditor.componentDefinition.schema,name:e.currentEditor.name,debug:e.debug,onError:e.error,onClose:e.close},null,40,["schema","name","debug","onError","onClose"])):t.createCommentVNode("",!0),e.debug&&e.currentEditor?(t.openBlock(),t.createElementBlock("div",Sa,[ba,t.createElementVNode("ul",null,[t.createElementVNode("li",null," Component Name: "+t.toDisplayString(e.currentEditor.componentDefinition.name),1),t.createElementVNode("li",null," Component Type: "+t.toDisplayString(e.currentEditor.componentDefinition.schema.type),1)])])):t.createCommentVNode("",!0)])])}const $a=h(ha,[["render",Ea],["__scopeId","data-v-280d2014"]]);let y={mounted:function(e,n){if(y.onEventBound=y.onEvent.bind({el:e}),document.addEventListener("click",y.onEventBound),typeof n.value!="function")throw new Error("Argument must be a function");y.cb=n.value},cb:function(e){},onEvent:function(e){e.target===this.el||this.el.contains(e.target)||!y.cb||y.cb(e)},onEventBound:function(){},unbind:function(){document.removeEventListener("click",y.onEventBound)},update:function(e,n){if(typeof n.value!="function")throw new Error("Argument must be a function");y.cb=n.value}};function va(e){return e.directive("click-outside",y),e}function wa(e){return e==null||(e.config.globalProperties.$filters={moment:function(n,a,r){return n==null?"N/A":(r??(r="YYYY-MM-DDThh:mm:ss"),a??(a="M-D-YYYY h:mm A"),f(n,r).format(a))},capitalize:function(n){return n==null?"":n.charAt(0).toUpperCase()+n.slice(1)},maxsize:function(n,a,r){return n==null?"":n.length<=a?n:(r??(r="..."),n.substring(0,a)+r)},currency:function(n,a,r){return n==null?"":(a??(a="en-US"),r??(r={style:"currency",currency:"USD"}),Intl.NumberFormat(a,r).format(n))}}),e}class Q{}const Ba=t.defineComponent({name:"DataHandler",data:function(){return{count:0,timer:0,internalData:this.model}},props:{model:{type:Object,default:{}},schema:{type:Q,default:new Q}},methods:{fetchData:function(){if(!this.schema.loadUrl)return;let e=this;p.post("/api/query",{query:e.schema.datalistQuery}).onSuccess(n=>{e.schema.datalist=n.data.dropDown}).withStorageMode($.StorageAndUpdate).send()},saveData:function(){},deleteData:function(){}},created:function(){if(!this.schema.datalistQuery)return;this.fetchData()},watch:{model:function(e,n){n!==e&&(this.internalModel=e)}}});function Na(e,n,a,r,i,s){return t.openBlock(),t.createElementBlock("div",null,[t.createTextVNode(" ASDF "),(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.schema.children,o=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(o.type),{key:o.type,data:e.internalData,schema:o,onSave:e.saveData,onDelete:e.deleteData,onLoad:e.fetchData},null,40,["data","schema","onSave","onDelete","onLoad"]))),128)),t.createElementVNode("pre",null,t.toDisplayString(e.internalData),1)])}const Ca=h(Ba,[["render",Na]]),Ma=t.defineComponent({data:function(){return{items:this.items,showDropDown:!1}},props:{items:Array},methods:{showDropDownFunc:function(){this.showDropDown=!0},hideDropDownFunc:function(){this.showDropDown=!1}},directives:{clickOutside:y}}),Da={class:"unstyled"},Ta={class:"grouped"},Fa=["href"];function qa(e,n,a,r,i,s){const o=t.resolveDirective("click-outside");return t.withDirectives((t.openBlock(),t.createElementBlock("ul",Da,[t.createElementVNode("li",null,[t.createElementVNode("a",{class:"fas fa-circle-user",href:"#",onClick:n[0]||(n[0]=t.withModifiers((...l)=>e.showDropDownFunc&&e.showDropDownFunc(...l),["stop","prevent"]))}),t.createElementVNode("div",{class:t.normalizeClass({show:e.showDropDown,"z-depth-2":e.showDropDown,hidden:!e.showDropDown})},[t.createElementVNode("ul",Ta,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(e.items,l=>(t.openBlock(),t.createElementBlock("li",{key:l.display},[t.createElementVNode("a",{href:l.url,class:t.normalizeClass([l.icon])},t.toDisplayString(l.display),11,Fa)]))),128))])],2)])])),[[o,e.hideDropDownFunc]])}const Ia=h(Ma,[["render",qa]]),ja=e=>{e.component("mithril-data-handler",Ca),e.component("mithril-side-menu",Ia)},Aa={install:(e,n)=>{wa(e),va(e),ja(e)}};class La{constructor(){Z(this,"AdminApp");d.debug("Admin loading"),this.AdminApp=this.SetupComponents(t.createApp({data:function(){return{}}})),this.AdminApp.mount("#AdminApplication"),d.debug("Admin loaded")}SetupComponents(n){return n.use(Aa),n.component("admin-application",$a),n.component("settings-editor-component",zn),n.component("data-editor-component",ma),n}}return(()=>{new La})()});
