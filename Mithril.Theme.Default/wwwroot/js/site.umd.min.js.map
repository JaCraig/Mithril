{"version":3,"file":"site.umd.min.js","sources":["../../../Mithril.Web.Common/build/ts/Framework/Extensions/HTMLElement.ts","../../../Mithril.Web.Common/build/ts/Framework/Extensions/NodeList.ts","../../../Mithril.Web.Common/build/ts/Framework/Validation/FormValidation.ts","../../../Mithril.Web.Common/build/ts/Framework/Logging/Signature.ts","../../../Mithril.Web.Common/build/ts/Framework/Logging/ErrorLogging.ts","../../../Mithril.Web.Common/build/ts/Framework/WebStorage/LocalStorage.ts","../../../Mithril.Web.Common/build/ts/Framework/WebStorage/SessionStorage.ts","../../../Mithril.Web.Common/build/ts/Framework/Database/Database.ts","../../../Mithril.Web.Common/build/ts/Framework/AJAX/Request.ts","../../../Mithril.Web.Common/build/ts/Framework/IO/Downloader.ts","../../../Mithril.Web.Common/build/ts/Framework/Hotkey/Globals.ts","../../../Mithril.Web.Common/build/ts/Framework/Hotkey/Keypress.ts","../../../Mithril.Web.Common/build/ts/Framework/Hotkey/Sequence.ts","../../../Mithril.Web.Common/build/ts/Framework/Hotkey/Scope.ts","../../../Mithril.Web.Common/build/ts/Framework/Hotkey/Hotkeys.ts","../../../Mithril.Web.Common/build/ts/Framework/Types/StringDictionary.ts","../../../Mithril.Web.Common/build/ts/Framework/Router/PathPart.ts","../../../Mithril.Web.Common/build/ts/Framework/Router/QueryPart.ts","../../../Mithril.Web.Common/build/ts/Framework/Router/HashPart.ts","../../../Mithril.Web.Common/build/ts/Framework/Router/Route.ts","../../../Mithril.Web.Common/build/ts/Framework/Router/Router.ts","../../../Mithril.Web.Common/build/ts/Framework/History/PageHistory.ts","../../../Mithril.Web.Common/build/ts/Framework/Framework.ts","../../../Mithril.Web.Common/build/ts/Component/VueExtensions/VueDirectives.ts","../../../Mithril.Web.Common/build/ts/Component/DataTypes/ComponentSchema.ts","../../../Mithril.Web.Common/build/ts/Framework/Extensions/String.ts","../../../Mithril.Web.Common/build/ts/Component/DataHandler.vue","../../../Mithril.Web.Common/build/ts/Component/DataHandler.vue?vue&type=template&id=2d9b707c&lang.js","../../../Mithril.Web.Common/build/ts/Component/VueExtensions/VueComponents.ts","../../../Mithril.Web.Common/build/ts/Component/VueExtensions/MithrilPlugin.ts","../../../Mithril.Web.Common/build/ts/Component/VueExtensions/VueFilters.ts","../../../Mithril.Web.Common/build/ts/Mithril.ts","../../build/ts/default.ts"],"sourcesContent":["declare interface HTMLElement {\r\n    replaceClass(originalClassName: string, newClassName: string): void;\r\n    toggleClass(originalClassName: string, newClassName: string): void;\r\n    removeClass(className: string): void;\r\n    addClass(className: string): void;\r\n    show(): void;\r\n    hide(): void;\r\n    attribute(name: string, value?: string): string;\r\n    hasClass(className: string): boolean;\r\n    getParentByClass(className: string): HTMLElement;\r\n}\r\n\r\n/**\r\n * Determines a parent object that has the class name specified\r\n *\r\n * @param {string} className\r\n * @returns {HTMLElement}\r\n */\r\nHTMLElement.prototype.getParentByClass = function (className: string): HTMLElement {\r\n    let element = this.parentElement;\r\n    while (element && !element.hasClass(className)) {\r\n        element = element.parentElement;\r\n    }\r\n    return element;\r\n};\r\n\r\n/**\r\n * Determines if a CSS class is present\r\n *\r\n * @param {string} className\r\n * @returns {boolean}\r\n */\r\nHTMLElement.prototype.hasClass = function (className: string): boolean {\r\n    return (\" \" + this.className + \" \").indexOf(\" \" + className + \" \") > -1;\r\n};\r\n\r\n/**\r\n * Replaces a CSS class in the element\r\n *\r\n * @param {string} originalClassName\r\n * @param {string} newClassName\r\n */\r\nHTMLElement.prototype.replaceClass = function (originalClassName: string, newClassName: string): void {\r\n    let tempClassName = \" \" + this.className + \" \";\r\n    if (tempClassName.indexOf(originalClassName) === -1) {\r\n        this.addClass(newClassName);\r\n        return;\r\n    }\r\n    if (newClassName === \"\") {\r\n        this.className = tempClassName.replace(new RegExp(\" \" + originalClassName + \" \", \"gi\"), \" \").trim();\r\n    } else {\r\n        this.className = tempClassName.replace(new RegExp(\" \" + originalClassName + \" \", \"gi\"), \" \" + newClassName + \" \").trim();\r\n    }\r\n};\r\n\r\n/**\r\n * Toggles between two CSS classes.\r\n *\r\n * @param {string} originalClassName\r\n * @param {string} newClassName\r\n * @returns {void}\r\n */\r\nHTMLElement.prototype.toggleClass = function (originalClassName: string, newClassName: string): void {\r\n    if (this.hasClass(originalClassName)) {\r\n        this.replaceClass(originalClassName, newClassName);\r\n        return;\r\n    }\r\n    this.replaceClass(newClassName, originalClassName);\r\n};\r\n\r\n/**\r\n * Removes a CSS class from the element\r\n *\r\n * @param {string} className\r\n */\r\nHTMLElement.prototype.removeClass = function (className: string): void {\r\n    this.replaceClass(className, \"\");\r\n};\r\n\r\n/**\r\n * Adds a CSS class to the element\r\n *\r\n * @param {string} className\r\n */\r\nHTMLElement.prototype.addClass = function (className: string): void {\r\n    if (!this.hasClass(className)) {\r\n        this.className += \" \" + className;\r\n    }\r\n};\r\n\r\n/**\r\n * Shows the element\r\n *\r\n */\r\nHTMLElement.prototype.show = function (): void {\r\n    this.replaceClass(\"hidden\", \"show\");\r\n    this.addClass(\"show\");\r\n};\r\n\r\n/**\r\n * Hides the element\r\n */\r\nHTMLElement.prototype.hide = function (): void {\r\n    this.replaceClass(\"show\", \"hidden\");\r\n    this.addClass(\"hidden\");\r\n};\r\n\r\n/**\r\n * Gets or sets an attribute of the element based on the name specified.\r\n *\r\n * @param {string} name\r\n * @param {string} [value=null]\r\n * @returns {string}\r\n */\r\nHTMLElement.prototype.attribute = function (name: string, value: string = null): string {\r\n    if (value != null) {\r\n        this.setAttribute(name, value);\r\n        return value;\r\n    }\r\n    return this.getAttribute(name);\r\n};","declare interface NodeList {\r\n    map<TResult>(callback: (x: Node) => TResult): TResult[];\r\n    filter(callback: (x: Node) => boolean): Node[];\r\n}\r\n\r\n/**\r\n * Basically runs through a node list, runs a function on it and returns the result\r\n *\r\n * @template TResult\r\n * @param {(x: Node) => TResult} callback\r\n * @returns {TResult[]}\r\n */\r\nNodeList.prototype.map = function <TResult>(callback: (x: Node) => TResult): TResult[] {\r\n    let ReturnValues: TResult[] = [];\r\n    for (let x = 0; x < this.length; ++x) {\r\n        ReturnValues = ReturnValues.concat(callback(this[x]));\r\n    }\r\n    return ReturnValues;\r\n};\r\n\r\n/**\r\n * Filters a node list based on the function specified\r\n *\r\n * @param {(x: Node) => boolean} callback\r\n * @returns {Node[]}\r\n */\r\nNodeList.prototype.filter = function (callback: (x: Node) => boolean): Node[] {\r\n    let ReturnValues: Node[] = [];\r\n    for (let x = 0; x < this.length; ++x) {\r\n        if (callback(this[x])) {\r\n            ReturnValues = ReturnValues.concat(this[x]);\r\n        }\r\n    }\r\n    return ReturnValues;\r\n};","import \"../Extensions/HTMLElement\";\r\nimport \"../Extensions/NodeList\";\r\n\r\nimport { StringDictionary } from \"../Types/StringDictionary\";\r\n\r\n// Class to help with form validation\r\nexport class FormValidation {\r\n    constructor() {\r\n        this.errors = [];\r\n        this.messageAttributes = {};\r\n        this.messageAttributes[\"patternMismatch\"] = \"data-error-message-pattern-mismatch\";\r\n        this.messageAttributes[\"rangeOverflow\"] = \"data-error-message-range-overflow\";\r\n        this.messageAttributes[\"rangeUnderflow\"] = \"data-error-message-range-underflow\";\r\n        this.messageAttributes[\"stepMismatch\"] = \"data-error-message-step-mismatch\";\r\n        this.messageAttributes[\"tooLong\"] = \"data-error-message-too-long\";\r\n        this.messageAttributes[\"tooShort\"] = \"data-error-message-too-short\";\r\n        this.messageAttributes[\"badInput\"] = \"data-error-message-bad-input\";\r\n        this.messageAttributes[\"typeMismatch\"] = \"data-error-message-type-mismatch\";\r\n        this.messageAttributes[\"valueMissing\"] = \"data-error-message-value-missing\";\r\n    }\r\n\r\n    // The errors found when validating\r\n    public errors: string[];\r\n\r\n    // message attribute dictionary\r\n    private messageAttributes: StringDictionary<string>;\r\n\r\n    // initializes the validation system for adding custom error messages\r\n    public initialize(): void {\r\n        let inputElements = this.map(document.getElementsByTagName(\"input\"), x => <HTMLInputElement>x).filter(x => x.willValidate);\r\n        for (let x = 0; x < inputElements.length; ++x) {\r\n            if (inputElements[x].type.toUpperCase() === \"RADIO\"\r\n                || inputElements[x].type.toUpperCase() === \"CHECKBOX\") {\r\n                inputElements[x].addEventListener(\"change\", y => this.inputHandler(<HTMLInputElement>y.target));\r\n            } else {\r\n                inputElements[x].addEventListener(\"input\", y => this.inputHandler(<HTMLInputElement>y.target));\r\n            }\r\n            inputElements[x].addEventListener(\"invalid\", y => this.invalidInputHandler(<HTMLInputElement>y.target));\r\n        }\r\n        let textAreaElements = this.map(document.getElementsByTagName(\"textarea\"), x => <HTMLTextAreaElement>x).filter(x => x.willValidate);\r\n        for (let x = 0; x < textAreaElements.length; ++x) {\r\n            textAreaElements[x].addEventListener(\"change\", y => this.textAreaHandler(<HTMLTextAreaElement>y.target));\r\n            textAreaElements[x].addEventListener(\"invalid\", y => this.invalidTextAreaHandler(<HTMLTextAreaElement>y.target));\r\n        }\r\n        let selectElements = this.map(document.getElementsByTagName(\"select\"), x => <HTMLSelectElement>x).filter(x => x.willValidate);\r\n        for (let x = 0; x < selectElements.length; ++x) {\r\n            selectElements[x].addEventListener(\"change\", y => this.selectHandler(<HTMLSelectElement>y.target));\r\n            selectElements[x].addEventListener(\"invalid\", y => this.invalidSelectHandler(<HTMLSelectElement>y.target));\r\n        }\r\n    }\r\n\r\n    private map<TResult>(elements: HTMLCollectionOf<Element>, callback: (x: Node) => TResult): TResult[] {\r\n        let ReturnValues: TResult[] = [];\r\n        for (let x = 0; x < elements.length; ++x) {\r\n            ReturnValues = ReturnValues.concat(callback(elements[x]));\r\n        }\r\n        return ReturnValues;\r\n    }\r\n\r\n    private filter(elements: HTMLCollectionOf<Element>, callback: (x: Node) => boolean): Node[] {\r\n        let ReturnValues: Node[] = [];\r\n        for (let x = 0; x < elements.length; ++x) {\r\n            if (callback(elements[x])) {\r\n                ReturnValues = ReturnValues.concat(elements[x]);\r\n            }\r\n        }\r\n        return ReturnValues;\r\n    }\r\n\r\n    // Initialize an individual form\r\n    public initializeForm(form: HTMLFormElement): void {\r\n        let inputElements = this.map(form.getElementsByTagName(\"input\"), x => <HTMLInputElement>x).filter(x => x.willValidate);\r\n        for (let x = 0; x < inputElements.length; ++x) {\r\n            if (inputElements[x].type.toUpperCase() === \"RADIO\"\r\n                || inputElements[x].type.toUpperCase() === \"CHECKBOX\") {\r\n                inputElements[x].addEventListener(\"change\", y => this.inputHandler(<HTMLInputElement>y.target));\r\n            } else {\r\n                inputElements[x].addEventListener(\"input\", y => this.inputHandler(<HTMLInputElement>y.target));\r\n            }\r\n            inputElements[x].addEventListener(\"invalid\", y => this.invalidInputHandler(<HTMLInputElement>y.target));\r\n        }\r\n        let textAreaElements = this.map(form.getElementsByTagName(\"textarea\"), x => <HTMLTextAreaElement>x).filter(x => x.willValidate);\r\n        for (let x = 0; x < textAreaElements.length; ++x) {\r\n            textAreaElements[x].addEventListener(\"change\", y => this.textAreaHandler(<HTMLTextAreaElement>y.target));\r\n            textAreaElements[x].addEventListener(\"invalid\", y => this.invalidTextAreaHandler(<HTMLTextAreaElement>y.target));\r\n        }\r\n        let selectElements = this.map(form.getElementsByTagName(\"select\"), x => <HTMLSelectElement>x).filter(x => x.willValidate);\r\n        for (let x = 0; x < selectElements.length; ++x) {\r\n            selectElements[x].addEventListener(\"change\", y => this.selectHandler(<HTMLSelectElement>y.target));\r\n            selectElements[x].addEventListener(\"invalid\", y => this.invalidSelectHandler(<HTMLSelectElement>y.target));\r\n        }\r\n    }\r\n\r\n    // invalid input handler\r\n    private invalidInputHandler(input: HTMLInputElement): void {\r\n        if (!input.validity.valid) {\r\n            let errorMessages = this.getErrorMessages(input, input.validity);\r\n            if (errorMessages.length > 0) {\r\n                input.setCustomValidity(errorMessages.join(\"\\n\"));\r\n            }\r\n        }\r\n    }\r\n\r\n    // invalid text area handler\r\n    private invalidTextAreaHandler(textarea: HTMLTextAreaElement): void {\r\n        if (!textarea.validity.valid) {\r\n            let errorMessages = this.getErrorMessages(textarea, textarea.validity);\r\n            if (errorMessages.length > 0) {\r\n                textarea.setCustomValidity(errorMessages.join(\"\\n\"));\r\n            }\r\n        }\r\n    }\r\n\r\n    // invalid select handler\r\n    private invalidSelectHandler(select: HTMLSelectElement): void {\r\n        if (!select.validity.valid) {\r\n            let errorMessages = this.getErrorMessages(select, select.validity);\r\n            if (errorMessages.length > 0) {\r\n                select.setCustomValidity(errorMessages.join(\"\\n\"));\r\n            }\r\n        }\r\n    }\r\n\r\n    // Input handler\r\n    private inputHandler(input: HTMLInputElement): void {\r\n        if (input.type.toUpperCase() === \"RADIO\") {\r\n            let elements = document.getElementsByName(input.name);\r\n            for (let x = 0; x < elements.length; ++x) {\r\n                let element = <HTMLInputElement>elements[x];\r\n                element.setCustomValidity(\"\");\r\n            }\r\n        } else {\r\n            input.setCustomValidity(\"\");\r\n        }\r\n        input.checkValidity();\r\n    }\r\n\r\n    // text area handler\r\n    private textAreaHandler(textarea: HTMLTextAreaElement): void {\r\n        textarea.setCustomValidity(\"\");\r\n        textarea.checkValidity();\r\n    }\r\n\r\n    // select handler\r\n    private selectHandler(select: HTMLSelectElement): void {\r\n        select.setCustomValidity(\"\");\r\n        select.checkValidity();\r\n    }\r\n\r\n    // Validates all elements, returning false if there are errors, true otherwise.\r\n    public validate(): boolean {\r\n        let result = true;\r\n        this.errors = [];\r\n        let inputElements = this.filter(document.getElementsByTagName(\"input\"),\r\n            x => !this.validateInput((<HTMLInputElement>x)));\r\n        result = result && inputElements.length === 0;\r\n        let selectElements = this.filter(document.getElementsByTagName(\"select\"),\r\n            x => !this.validateSelect((<HTMLSelectElement>x)));\r\n        result = result && selectElements.length === 0;\r\n        let textareaElements = this.filter(document.getElementsByTagName(\"textarea\"),\r\n            x => !this.validateTextArea((<HTMLTextAreaElement>x)));\r\n        result = result && textareaElements.length === 0;\r\n        return result;\r\n    }\r\n\r\n    // Validates all elements in the form, returning the list of error messages.\r\n    public validateForm(form: HTMLFormElement): String[] {\r\n        let result: String[] = [];\r\n        this.errors = [];\r\n        let inputElements = this.filter(form.getElementsByTagName(\"input\"),\r\n            x => !this.validateInput((<HTMLInputElement>x)))\r\n            .map(x => this.getErrorMessages(<HTMLInputElement>x, (<HTMLInputElement>x).validity))\r\n            .filter(x => x.length !== 0);\r\n        for (let x = 0; x < inputElements.length; ++x) {\r\n            result = result.concat(inputElements[x]);\r\n        }\r\n        let selectElements = this.filter(form.getElementsByTagName(\"select\"),\r\n            x => !this.validateSelect((<HTMLSelectElement>x)))\r\n            .map(x => this.getErrorMessages(<HTMLSelectElement>x, (<HTMLSelectElement>x).validity))\r\n            .filter(x => x.length !== 0);\r\n        for (let x = 0; x < selectElements.length; ++x) {\r\n            result = result.concat(selectElements[x]);\r\n        }\r\n        let textareaElements = this.filter(form.getElementsByTagName(\"textarea\"),\r\n            x => !this.validateTextArea((<HTMLTextAreaElement>x)))\r\n            .map(x => this.getErrorMessages(<HTMLTextAreaElement>x, (<HTMLTextAreaElement>x).validity))\r\n            .filter(x => x.length !== 0);\r\n        for (let x = 0; x < textareaElements.length; ++x) {\r\n            result = result.concat(textareaElements[x]);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // Validates an individual element, returning the list of error messages.\r\n    public validateElement(element: HTMLElement): String[] {\r\n        let result: String[] = [];\r\n        if (element.tagName === \"INPUT\" && !this.validateInput((<HTMLInputElement>element))) {\r\n            let tempResults = this.getErrorMessages((<HTMLInputElement>element), (<HTMLInputElement>element).validity)\r\n                .filter(x => x.length !== 0);\r\n            for (let x = 0; x < tempResults.length; ++x) {\r\n                result = result.concat(tempResults[x]);\r\n            }\r\n        } else if (element.tagName === \"SELECT\" && !this.validateSelect((<HTMLSelectElement>element))) {\r\n            let tempResults = this.getErrorMessages((<HTMLSelectElement>element), (<HTMLSelectElement>element).validity)\r\n                .filter(x => x.length !== 0);\r\n            for (let x = 0; x < tempResults.length; ++x) {\r\n                result = result.concat(tempResults[x]);\r\n            }\r\n        } else if (element.tagName === \"TEXTAREA\" && !this.validateTextArea((<HTMLTextAreaElement>element))) {\r\n            let tempResults = this.getErrorMessages((<HTMLTextAreaElement>element), (<HTMLTextAreaElement>element).validity)\r\n                .filter(x => x.length !== 0);\r\n            for (let x = 0; x < tempResults.length; ++x) {\r\n                result = result.concat(tempResults[x]);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // validates a select object\r\n    private validateSelect(select: HTMLSelectElement): boolean {\r\n        if (!select.checkValidity()) {\r\n            let tempValue = this.getErrorMessages(select, select.validity);\r\n            if (tempValue.length !== 0) {\r\n                this.errors = this.errors.concat(tempValue);\r\n            }\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    // validates a text area object\r\n    private validateTextArea(textarea: HTMLTextAreaElement): boolean {\r\n        if (!textarea.checkValidity()) {\r\n            let tempValue = this.getErrorMessages(textarea, textarea.validity);\r\n            if (tempValue.length !== 0) {\r\n                this.errors = this.errors.concat(tempValue);\r\n            }\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    // gets the error messages based on the validation state and element's defined error messages\r\n    private getErrorMessages(element: HTMLElement, validity: ValidityState): string[] {\r\n        let tempValue: string[] = [];\r\n        for (let key in this.messageAttributes) {\r\n            if ((<any>validity)[key]) {\r\n                let message = element.attribute(this.messageAttributes[key]);\r\n                if (message !== null) {\r\n                    tempValue = tempValue.concat(message);\r\n                }\r\n            }\r\n        }\r\n        if (tempValue.length === 0) {\r\n            let generalMessage = element.attribute(\"data-error-message\");\r\n            if (generalMessage !== null) {\r\n                tempValue = tempValue.concat(generalMessage);\r\n            } else {\r\n                tempValue = tempValue.concat((<HTMLInputElement>element).validationMessage);\r\n            }\r\n        }\r\n        return tempValue;\r\n    }\r\n\r\n    // validates an input object\r\n    private validateInput(input: HTMLInputElement): boolean {\r\n        if (!input.checkValidity()) {\r\n            let tempValue = this.getErrorMessages(input, input.validity);\r\n            if (tempValue.length !== 0) {\r\n                this.errors = this.errors.concat(tempValue);\r\n            }\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n}","export class Signature {\r\n    //Constructor\r\n    constructor() {\r\n        this.params = [];\r\n    }\r\n\r\n    //Function name\r\n    public name: string;\r\n\r\n    //Function parameters\r\n    public params: any[];\r\n\r\n    //Converts the class to a string\r\n    public toString(): string {\r\n        let params = this.params.length > 0\r\n            ? \"'\" + this.params.join(\"', '\") + \"'\"\r\n            : \"\";\r\n        return this.name + \"(\" + params + \")\";\r\n    }\r\n}","import { Signature } from \"./Signature\";\r\n\r\ndeclare global {\r\n    interface Function {\r\n        trace(): any[];\r\n        signature(): Signature;\r\n        getName(): any;\r\n    }\r\n}\r\n\r\n// declare var Function: FunctionConstructor;\r\n\r\n//Does a stack trace of the function.\r\nFunction.prototype.trace = function () {\r\n    var trace = [];\r\n    var curr = this;\r\n    while (curr) {\r\n        trace.push(curr.signature());\r\n        curr = curr.caller;\r\n    }\r\n    return trace;\r\n};\r\n\r\n//Gets the function's signature.\r\nFunction.prototype.signature = function () {\r\n    var signature = new Signature();\r\n    signature.name = this.getName();\r\n    if (this.arguments) {\r\n        for (var i = 0; i < this.arguments.length; i++) {\r\n            signature.params.push(this.arguments[i]);\r\n        }\r\n    }\r\n    return signature;\r\n};\r\n\r\n//Gets the function's name if it has one.\r\nFunction.prototype.getName = function () {\r\n    if (this.name) {\r\n        return this.name;\r\n    }\r\n    var definition = this.toString().split(\"\\n\")[0];\r\n    var exp = /^function ([^\\s(]+).+/;\r\n    if (exp.test(definition)) {\r\n        return definition.split(\"\\n\")[0].replace(exp, \"$1\") || \"anonymous\";\r\n    }\r\n    return \"anonymous\";\r\n};\r\n\r\n//Handles error logging\r\nexport class ErrorLogging {\r\n    //constructor\r\n    constructor() {\r\n        this.logError = (ex, stack) => { };\r\n    }\r\n\r\n    //Logs the error message. Includes the message and stack trace information.\r\n    public logError: (message: string, stack: string) => void;\r\n\r\n    //Sets the logging function that the system uses\r\n    public setLoggingFunction(logger: (message: string, stack: string) => void): void {\r\n        this.logError = logger;\r\n    }\r\n\r\n    //called when an error is thrown.\r\n    public onError(message: string, filename?: string, lineno?: number, colno?: number, error?: Error): void {\r\n        this.logError(message, error?.stack || \"\");\r\n    }\r\n}","import { IStorage } from './Interfaces/IStorage'\r\n\r\n// Stores data locally on the browser\r\nexport class LocalStorage implements IStorage {\r\n    // sets the value of an item for long term storage\r\n    public set(key: string, value: string): void {\r\n        localStorage.setItem(key, value);\r\n    }\r\n\r\n    // sets the value of an item for long term storage (used when saving objects)\r\n    public setObject(key: string, value: any): void {\r\n        this.set(key, JSON.stringify(value));\r\n    }\r\n\r\n    // gets a value based on the key specified\r\n    public get(key: string, defaultValue = \"\"): any {\r\n        return localStorage.getItem(key) || defaultValue;\r\n    }\r\n\r\n    // Returns true if the key is present in local storage, false otherwise.\r\n    public has(key: string): boolean {\r\n        return this.get(key, null) !== null;\r\n    }\r\n\r\n    // Removes an item from local storage\r\n    public remove(key: string): void {\r\n        localStorage.removeItem(key);\r\n    }\r\n\r\n    // Clears local storage of all items\r\n    public clear(): void {\r\n        localStorage.clear();\r\n    }\r\n\r\n    // Returns the number of items in storage\r\n    get length(): number {\r\n        return localStorage.length;\r\n    }\r\n\r\n    // Gets the key of the item at the index specified\r\n    public key(index: number): string {\r\n        return localStorage.key(index);\r\n    }\r\n\r\n    // gets a value based on the key specified (used when saving objects)\r\n    public getObject(key: string, defaultValue: any = null): any {\r\n        let value = this.get(key);\r\n        return (value && JSON.parse(value)) || defaultValue;\r\n    }\r\n}","import { IStorage } from './Interfaces/IStorage'\r\n\r\n// Stores data for the session on the browser\r\nexport class SessionStorage implements IStorage {\r\n    // sets the value of an item for long term storage\r\n    public set(key: string, value: string): void {\r\n        sessionStorage.setItem(key, value);\r\n    }\r\n\r\n    // sets the value of an item for long term storage (used when saving objects)\r\n    public setObject(key: string, value: any): void {\r\n        this.set(key, JSON.stringify(value));\r\n    }\r\n\r\n    // gets a value based on the key specified\r\n    public get(key: string, defaultValue = \"\"): any {\r\n        return sessionStorage.getItem(key) || defaultValue;\r\n    }\r\n\r\n    // Returns true if the key is present in local storage, false otherwise.\r\n    public has(key: string): boolean {\r\n        return this.get(key, null) !== null;\r\n    }\r\n\r\n    // Removes an item from local storage\r\n    public remove(key: string): void {\r\n        sessionStorage.removeItem(key);\r\n    }\r\n\r\n    // Clears local storage of all items\r\n    public clear(): void {\r\n        sessionStorage.clear();\r\n    }\r\n\r\n    // Returns the number of items in storage\r\n    get length(): number {\r\n        return sessionStorage.length;\r\n    }\r\n\r\n    // Gets the key of the item at the index specified\r\n    public key(index: number): string {\r\n        return sessionStorage.key(index);\r\n    }\r\n\r\n    // gets a value based on the key specified (used when saving objects)\r\n    public getObject(key: string, defaultValue: any = null): any {\r\n        let value = this.get(key);\r\n        return (value && JSON.parse(value)) || defaultValue;\r\n    }\r\n}","// Database connection class\r\nexport class DatabaseConnection {\r\n    // constructor\r\n    constructor(dbName: string, tables: string[], version: number) {\r\n        this.DBName = dbName;\r\n        this.Version = version;\r\n        let request = indexedDB.open(dbName, version);\r\n        request.onupgradeneeded = (ev: any) => {\r\n            this.database = ev.target.result;\r\n            for (let x = 0; x < tables.length; ++x) {\r\n                let table = tables[x];\r\n                if (this.database.objectStoreNames.contains(table)) {\r\n                    this.database.deleteObjectStore(table);\r\n                }\r\n                this.database.createObjectStore(table);\r\n            }\r\n        };\r\n        request.onsuccess = (ev: any) => {\r\n            this.database = ev.target.result;\r\n        };\r\n    }\r\n\r\n    // Database name\r\n    private DBName: string;\r\n\r\n    // database version\r\n    private Version: number;\r\n\r\n    // open the database table\r\n    public openDatabase(onsuccess: (connection: DatabaseConnection) => any): void {\r\n        let request = indexedDB.open(this.DBName, this.Version);\r\n        request.onsuccess = (ev: any) => {\r\n            this.database = ev.target.result;\r\n            return onsuccess(this);\r\n        };\r\n    }\r\n\r\n    public add(table: string, obj: any, key: IDBValidKey): void {\r\n        let req = this.database.transaction(table, \"readwrite\").objectStore(table).put(obj, key);\r\n    }\r\n\r\n    public remove(table: string, key: IDBValidKey): void {\r\n        let req = this.database.transaction(table, \"readwrite\").objectStore(table).delete(key);\r\n    }\r\n\r\n    public getByKey(table: string, key: IDBValidKey, onSuccess: (ev: Event) => any): void {\r\n        let req = this.database.transaction(table, \"readwrite\").objectStore(table).get(key);\r\n        req.onsuccess = onSuccess;\r\n    }\r\n\r\n    public getKeys(table: string, onSuccess: (ev: Event) => any): void {\r\n        let req = this.database.transaction(table, \"readwrite\").objectStore(table).getAllKeys();\r\n        req.onsuccess = onSuccess;\r\n    }\r\n\r\n    public get(table: string, query: string, onSuccess: (ev: Event) => any): void {\r\n        let req = this.database.transaction(table, \"readwrite\").objectStore(table).get(query);\r\n        req.onsuccess = onSuccess;\r\n    }\r\n\r\n    public getAll(table: string, onSuccess: (ev: Event) => any, query?: string): void {\r\n        let req = this.database.transaction(table, \"readwrite\").objectStore(table).getAll(query);\r\n        req.onsuccess = onSuccess;\r\n    }\r\n\r\n    // Database pointer\r\n    private database: IDBDatabase;\r\n}","import { DatabaseConnection } from \"../Database/Database\";\r\n\r\n//Ajax request that the system uses.\r\nexport class Request {\r\n    // Constructor\r\n    constructor(method: string, url: string, data?: any) {\r\n        this.url = url;\r\n        this.method = method.toUpperCase();\r\n        this.data = data;\r\n        this.headers = new Headers();\r\n        if (this.method !== \"GET\" &&\r\n            this.method !== \"HEAD\" &&\r\n            this.method !== \"DELETE\" &&\r\n            this.method !== \"TRACE\") {\r\n            this.type(\"application/json\");\r\n        }\r\n        this.accept(\"application/json\");\r\n        this.parser = x => x.json();\r\n        this.serializer = x => JSON.stringify(x);\r\n        this.storageMode = StorageMode.NetworkOnly;\r\n        this.databaseName = \"MithrilStorage\"\r\n        this.cacheKey = this.url + this.serializer(this.data);\r\n        this.credentials = \"same-origin\";\r\n    }\r\n\r\n    // The serializer that the application uses\r\n    private serializer: (data: any) => string;\r\n\r\n    // URL to call\r\n    private url: string;\r\n\r\n    // Credentials type sent with the request (\"same-origin\", \"include\", or \"omit\")\r\n    private credentials: RequestCredentials;\r\n\r\n    // Method to use when calling\r\n    private method: string;\r\n\r\n    // Success callback\r\n    private success: (response: any) => any;\r\n\r\n    // Parser callback\r\n    private parser: (response: Response) => Promise<any>;\r\n\r\n    // Data to send in the request\r\n    private data: any;\r\n\r\n    // Error callback\r\n    private error: (reason: any) => any;\r\n\r\n    // Any headers to add to the call\r\n    private headers: Headers;\r\n\r\n    // The cache key\r\n    private cacheKey: string;\r\n\r\n    // Database to cache the results\r\n    private databaseName: string;\r\n\r\n    // Storage mode\r\n    private storageMode: StorageMode;\r\n\r\n    // GET method.\r\n    public static get(url: string, data?: any): Request {\r\n        return Request.makeRequest(\"GET\", url, data);\r\n    }\r\n\r\n    // A request using a HTTP verb that is not GET, POST, PUT, or DELETE\r\n    public static makeRequest(method: string, url: string, data?: any): Request {\r\n        return new Request(method, url, data);\r\n    }\r\n\r\n    // POST method.\r\n    public static post(url: string, data?: any): Request {\r\n        return Request.makeRequest(\"POST\", url, data);\r\n    }\r\n\r\n    // PUT method.\r\n    public static put(url: string, data?: any): Request {\r\n        return Request.makeRequest(\"PUT\", url, data);\r\n    }\r\n\r\n    // DELETE method.\r\n    public static delete(url: string, data?: any): Request {\r\n        return Request.makeRequest(\"DELETE\", url, data);\r\n    }\r\n\r\n    // Adds a callback to call if the AJAX request succeeds.\r\n    public onSuccess(callback: (ev: any) => any): Request {\r\n        this.success = callback;\r\n        return this;\r\n    }\r\n\r\n    // Adds a callback to call if the AJAX request fails.\r\n    public onError(callback: (ev: any) => any): Request {\r\n        this.error = callback;\r\n        return this;\r\n    }\r\n\r\n    // Adds a header value to the AJAX request.\r\n    public setHeader(key: string, value: string): Request {\r\n        this.headers.set(key, value);\r\n        return this;\r\n    }\r\n\r\n    // Sets the cache key\r\n    public setCacheKey(key: string): Request {\r\n        this.cacheKey = key;\r\n        return this;\r\n    }\r\n\r\n    // Sets the credentials type used for the call\r\n    public setCredentials(type: RequestCredentials): Request {\r\n        this.credentials = type;\r\n        return this;\r\n    }\r\n\r\n    // Short hand for setting the content type header value\r\n    public type(value: string): Request {\r\n        return this.setHeader(\"Content-Type\", value);\r\n    }\r\n\r\n    // Short hand for setting the accepts header value\r\n    public accept(value: string): Request {\r\n        return this.setHeader(\"Accept\", value);\r\n    }\r\n\r\n    // Sets the parser that the request uses\r\n    public setParser(parser: (response: Response) => Promise<any>): Request {\r\n        this.parser = parser;\r\n        return this;\r\n    }\r\n\r\n    // Ensures that the result of the request will be cached and used in future requests.\r\n    public setMode(storageMode: StorageMode, databaseName: string = \"MithrilStorage\"): Request {\r\n        this.databaseName = databaseName;\r\n        this.storageMode = storageMode;\r\n        return this;\r\n    }\r\n\r\n    // Sets the serializer that the request uses\r\n    public setSerializer(serializer: (data: any) => string): Request {\r\n        this.serializer = serializer;\r\n        return this;\r\n    }\r\n\r\n    // Actually sends the request, parses it, and calls either the\r\n    // success or error functions if they exist.\r\n    public send(): void {\r\n        if (this.error === undefined || this.error === null) {\r\n            this.error = x => { };\r\n        }\r\n        if (this.success === undefined || this.success === null) {\r\n            this.success = x => { };\r\n        }\r\n        let serializedData = this.serializer(this.data);\r\n        if (this.storageMode === StorageMode.StorageFirst) {\r\n            Request.returnValueFromDB(this.cacheKey, this.databaseName, this.success);\r\n            this.queryNetwork(serializedData, this.cacheKey, this.databaseName, response => { }, response => {\r\n                Request.saveValueToDB(response, this.cacheKey, this.databaseName);\r\n            });\r\n            return;\r\n        }\r\n        if (this.storageMode === StorageMode.StorageAndUpdate) {\r\n            Request.returnValueFromDB(this.cacheKey, this.databaseName, this.success);\r\n            this.queryNetwork(serializedData, this.cacheKey, this.databaseName, response => { }, response => {\r\n                Request.saveValueToDB(response, this.cacheKey, this.databaseName);\r\n                this.success(response);\r\n            });\r\n            return;\r\n        }\r\n        if (this.storageMode === StorageMode.NetworkFirst) {\r\n            this.queryNetwork(serializedData, this.cacheKey, this.databaseName, this.success, response => {\r\n                Request.saveValueToDB(response, this.cacheKey, this.databaseName);\r\n                this.success(response);\r\n            });\r\n            return;\r\n        }\r\n        this.queryNetwork(serializedData, this.cacheKey, this.databaseName, x => { }, this.success);\r\n    }\r\n\r\n    // Saves a value to the database/cache\r\n    private static saveValueToDB(data: string, dataKey: string, databaseName: string) {\r\n        new DatabaseConnection(databaseName, [\"cache\", \"cacheExpirations\"], 1)\r\n            .openDatabase(database => {\r\n                if (data === undefined) {\r\n                    return;\r\n                }\r\n                database.add(\"cache\", data, dataKey);\r\n                database.add(\"cacheExpirations\", Date.now(), dataKey);\r\n            });\r\n    }\r\n\r\n    // Queries the network and saves the data to the appropriate cache table.\r\n    private queryNetwork(\r\n        serializedData: string,\r\n        dataKey: string,\r\n        databaseName: string,\r\n        offlineCallback: (response: any) => any,\r\n        onlineCallback: (response: any) => any) {\r\n        if (!navigator.onLine) {\r\n            if (this.storageMode === StorageMode.NetworkFirst) {\r\n                Request.returnValueFromDB(dataKey, databaseName, offlineCallback);\r\n            }\r\n            return;\r\n        }\r\n        fetch(this.url, {\r\n            credentials: this.credentials,\r\n            method: this.method,\r\n            body: serializedData,\r\n            headers: this.headers\r\n        })\r\n            .then(this.parser)\r\n            .then(onlineCallback)\r\n            .catch(this.error);\r\n    }\r\n\r\n    // Gets the value in the database and returns that for success.\r\n    private static returnValueFromDB(dataKey: string, databaseName: string, callback: (response: any) => any) {\r\n        new DatabaseConnection(databaseName, [\"cache\", \"cacheExpirations\"], 1)\r\n            .openDatabase(database => {\r\n                database.getByKey(\"cache\", dataKey, event => {\r\n                    let result = (<any>event.target).result;\r\n                    if (result === undefined) {\r\n                        return;\r\n                    }\r\n                    callback(result);\r\n                });\r\n            });\r\n    }\r\n}\r\n\r\n// Storage mode\r\nexport enum StorageMode {\r\n    // network first\r\n    NetworkFirst = 0,\r\n    // storage first\r\n    StorageFirst = 1,\r\n    // network only\r\n    NetworkOnly = 2,\r\n    // Storage and then update\r\n    StorageAndUpdate = 3\r\n}","import { BrowserUtils } from \"../Browser/BrowserUtils\";\r\n\r\n// Acts as a way to \"download\" or export data to a file in the browser via JS.\r\nexport class Downloader {\r\n    // Exports the array of entries to the file specified\r\n    public static exportData(data: Array<any>, columns: Array<ColumnHeader>, fileName: string = BrowserUtils.Id, type: FileTypes = FileTypes.CSV): void {\r\n        if (data.length == 0) {\r\n            return;\r\n        }\r\n        fileName = fileName || BrowserUtils.Id;\r\n        let returnValue = \"\";\r\n        if (type === FileTypes.CSV) {\r\n            returnValue = this.exportCSV(data, columns, fileName);\r\n        } else {\r\n            returnValue = data.join(\",\");\r\n        }\r\n        this.download(returnValue, fileName);\r\n    }\r\n\r\n    // Capitalizes a string's first character\r\n    private static capitalize(str: string | String): string {\r\n        if (!str) {\r\n            return \"\";\r\n        }\r\n        return str.charAt(0).toUpperCase() + str.slice(1);\r\n    }\r\n\r\n    // Exports a CSV of the data\r\n    private static exportCSV(data: Array<any>, columns: Array<ColumnHeader>, fileName: string): string {\r\n        let returnValue = \"\";\r\n        let columnNames = Object.keys(data[0]);\r\n        let splitter = \"\";\r\n        for (let z = 0; z < columnNames.length; ++z) {\r\n            let columnName = columnNames[z];\r\n            let actualName = columns.filter(function (column) {\r\n                return column.property === columnName;\r\n            });\r\n            if (actualName.length === 0) {\r\n                actualName = [{ display: columnName, property: columnName }];\r\n            }\r\n            let header = actualName[0]?.display || actualName[0]?.property || columnName;\r\n            returnValue += splitter + \"\\\"\" + this.capitalize(header) + \"\\\"\";\r\n            splitter = \",\";\r\n        }\r\n        returnValue += \"\\n\";\r\n        for (let x = 0; x < data.length; ++x) {\r\n            let row = data[x];\r\n            let columns = Object.keys(row);\r\n            splitter = \"\";\r\n            for (let y = 0; y < columns.length; ++y) {\r\n                returnValue += splitter + \"\\\"\" + row[columns[y]].replaceAll(\"\\\"\", \"'\") + \"\\\"\";\r\n                splitter = \",\";\r\n            }\r\n            returnValue += \"\\n\";\r\n        }\r\n        return returnValue;\r\n    }\r\n\r\n    // Downloads the data as the file specified\r\n    public static download(data: string, fileName: string): void {\r\n        if (data == null) {\r\n            return;\r\n        }\r\n        if ((<any>navigator).msSaveBlob) { // IE10+ : (has Blob, but not a[download] or URL)\r\n            (<any>navigator).msSaveBlob(new Blob([data]), fileName);\r\n            return;\r\n        }\r\n        var element = document.createElement('a');\r\n        element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(data));\r\n        element.setAttribute('download', fileName);\r\n\r\n        element.style.display = 'none';\r\n        document.body.appendChild(element);\r\n\r\n        element.click();\r\n\r\n        document.body.removeChild(element);\r\n    }\r\n}\r\n\r\nexport class ColumnHeader {\r\n    public display: String;\r\n    public property: String;\r\n}\r\n\r\nexport enum FileTypes {\r\n    CSV\r\n}","import { StringDictionary } from '../Types/StringDictionary'\r\n\r\n//Defines the hotkeys system's global values\r\nexport class Globals {\r\n    //Key mappings for various keys\r\n    public static keyMappings: StringDictionary<number> = {\r\n        'BACKSPACE': 8,\r\n        'TAB': 9,\r\n        'ENTER': 13,\r\n        'SHIFT': 16,\r\n        'CTRL': 17,\r\n        'ALT': 18,\r\n        'PAUSE': 19,\r\n        'CAPSLOCK': 20,\r\n        'ESCAPE': 27,\r\n        'SPACE': 32,\r\n        'PAGEUP': 33,\r\n        'PAGEDOWN': 34,\r\n        'END': 35,\r\n        'HOME': 36,\r\n        'LEFT': 37,\r\n        'UP': 38,\r\n        'RIGHT': 39,\r\n        'DOWN': 40,\r\n        'INS': 45,\r\n        'DEL': 46,\r\n        'META': 91,\r\n        '*': 106,\r\n        '+': 107,\r\n        'MINUS': 109,\r\n        'F1': 112,\r\n        'F2': 113,\r\n        'F3': 114,\r\n        'F4': 115,\r\n        'F5': 116,\r\n        'F6': 117,\r\n        'F7': 118,\r\n        'F8': 119,\r\n        'F9': 120,\r\n        'F10': 121,\r\n        'F11': 122,\r\n        'F12': 123,\r\n        'NUMLOCK': 144,\r\n        'SCROLLLOCK': 145,\r\n        ';': 186,\r\n        '=': 187,\r\n        '': 188,\r\n        '-': 189,\r\n        '.': 190,\r\n        '/': 191,\r\n        '`': 192,\r\n        '[': 219,\r\n        '\\\\': 220,\r\n        ']': 221,\r\n        \"'\": 222\r\n    };\r\n}","import { Globals } from './Globals'\r\n\r\n// Individual key press\r\nexport class Keypress {\r\n    // Constructor\r\n    constructor(keys: string) {\r\n        this.keys = this.getKeys(keys);\r\n    }\r\n\r\n    // actual key codes\r\n    private keys: number[];\r\n\r\n    // gets the key codes for the string passed in\r\n    private getKeys(keyCode: string): number[] {\r\n        return keyCode.toUpperCase().split(/-(?!$)/).map(x => Globals.keyMappings[x] || x.charCodeAt(0));\r\n    }\r\n\r\n    // determines if the key code is pressed\r\n    public isPressed(keyCode: number[]): boolean {\r\n        let keysPressed = keyCode;\r\n        if (keysPressed.length !== this.keys.length) {\r\n            return false;\r\n        }\r\n        for (let x = 0; x < keysPressed.length; ++x) {\r\n            if (this.keys.indexOf(keysPressed[x]) === -1) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}","import { Keypress } from './Keypress'\r\nimport { Scope } from './Scope'\r\n\r\n// Sequence of key presses\r\nexport class Sequence {\r\n    // constructor\r\n    constructor(keyCodes: string, callback: (event: KeyboardEvent, handler: any) => void) {\r\n        this.keyCodeSequence = keyCodes.toUpperCase();\r\n        this.keyCodes = keyCodes.toUpperCase().split(\" \").map(x => new Keypress(x));\r\n        this.callback = callback;\r\n        this.length = this.keyCodes.length;\r\n        this.isDefault = \"<*>\" === keyCodes;\r\n    }\r\n\r\n    // callback to run when keys are pressed\r\n    public callback: (event: KeyboardEvent, handler: any) => void;\r\n\r\n    // The key code sequence\r\n    public keyCodeSequence: string;\r\n\r\n    // The individual key presses in this sequence\r\n    private keyCodes: Keypress[];\r\n\r\n    // Length of the sequence\r\n    public length: number;\r\n\r\n    // determines if this a default catch\r\n    public isDefault: boolean;\r\n\r\n    // calls the callback function with the data specified\r\n    public call(keyCodes: number[][], event: KeyboardEvent, scope: Scope): boolean {\r\n        this.callback(event, { scope: scope, keysPressed: keyCodes });\r\n        return true;\r\n    }\r\n\r\n    // Runs the callback based on the keycode being pressed\r\n    public press(keyCodes: number[][], event: KeyboardEvent, scope: Scope): boolean {\r\n        let individualCodes = keyCodes;\r\n        if (individualCodes.length !== this.length) {\r\n            return false;\r\n        }\r\n        for (let x = 0; x < this.keyCodes.length; ++x) {\r\n            if (!this.keyCodes[x].isPressed(individualCodes[x])) {\r\n                return false;\r\n            }\r\n        }\r\n        return this.call(keyCodes, event, scope);\r\n    }\r\n\r\n    // determines if this is a partial match on a sequence\r\n    public isPartial(keyCodes: number[][]): boolean {\r\n        let individualCodes = keyCodes;\r\n        if (individualCodes.length > this.length) {\r\n            return false;\r\n        }\r\n        for (let x = 0; x < individualCodes.length; ++x) {\r\n            if (!this.keyCodes[x].isPressed(individualCodes[x])) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}","import { Sequence } from './Sequence'\r\n\r\n// Defines the scope for a series of sequences\r\nexport class Scope {\r\n    // constructor\r\n    constructor(public name: string) {\r\n    }\r\n\r\n    // The sequences available in this scope\r\n    private sequences: Sequence[] = [];\r\n\r\n    // determines if anything in this scope was pressed\r\n    public press(keyCodes: number[][], event: KeyboardEvent): boolean {\r\n        this.sequences = this.sequences.sort((x, y) => x.length > y.length ? 1 : -1);\r\n        for (let x = 0; x < this.sequences.length; ++x) {\r\n            if (this.sequences[x].press(keyCodes, event, this)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    // calls the default handler if one exists\r\n    public callDefault(keyCodes: number[][], event: KeyboardEvent): boolean {\r\n        let defaultItems = this.sequences.filter(x => x.isDefault);\r\n        if (defaultItems.length === 0) {\r\n            return false;\r\n        }\r\n        return defaultItems[0].call(keyCodes, event, this);\r\n    }\r\n\r\n    // determines if the sequence is a partial match\r\n    public isPartial(keyCodes: number[][]): boolean {\r\n        for (let x = 0; x < this.sequences.length; ++x) {\r\n            if (this.sequences[x].isPartial(keyCodes)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    // adds an individual sequence to the scope\r\n    public addSequence(keyCodes: string, callback: (event: KeyboardEvent, handler: any) => void): Scope {\r\n        this.removeSequence(keyCodes);\r\n        this.sequences.push(new Sequence(keyCodes, callback));\r\n        return this;\r\n    }\r\n\r\n    // removes an individual sequence from the scope\r\n    public removeSequence(keyCodes: string): Scope {\r\n        this.sequences = this.sequences.filter(x => x.keyCodeSequence !== keyCodes.toUpperCase());\r\n        return this;\r\n    }\r\n\r\n    // clears the sequences and scopes from the scope\r\n    public clear(): Scope {\r\n        this.sequences = [];\r\n        return this;\r\n    }\r\n}","import { IHotkeys } from './Interfaces/IHotkeys'\r\nimport { StringDictionary } from '../Types/StringDictionary'\r\nimport { Globals } from './Globals'\r\nimport { Scope } from './Scope'\r\n\r\n// Defines the hotkeys system\r\nexport class Hotkeys implements IHotkeys {\r\n    // constructor\r\n    constructor() {\r\n        this.scopes = {};\r\n        this.scopes[\"Default\"] = new Scope(\"Default\");\r\n        this.currentScope = this.scopes[\"Default\"];\r\n        this.filter = x => {\r\n            let tagName = ((<Element>x.target) || (<Element>x.srcElement)).tagName;\r\n            return tagName !== \"INPUT\"\r\n                && tagName !== \"SELECT\"\r\n                && tagName !== \"TEXTAREA\";\r\n        };\r\n        this.latestKeys = [];\r\n    }\r\n    // The scopes within the system\r\n    private scopes: StringDictionary<Scope>;\r\n\r\n    // The current scope that the system uses\r\n    private currentScope: Scope;\r\n\r\n    // latesst key presses\r\n    private latestKeys: number[][];\r\n\r\n    // filter used by the system to determine if it should capture the keys pressed\r\n    private filter: (event: KeyboardEvent) => boolean;\r\n\r\n    // Sets the current scope, adding it if it doesn't exist and returns it.\r\n    public setScope(name: string): Scope {\r\n        let scope = this.addScope(name);\r\n        this.currentScope = scope;\r\n        return scope;\r\n    }\r\n\r\n    // Adds a scope to the system and returns it (or returns it if it already exists)\r\n    public addScope(name: string): Scope {\r\n        let tempScope = this.scopes[name];\r\n        if (tempScope !== undefined) {\r\n            return tempScope;\r\n        }\r\n        tempScope = new Scope(name);\r\n        this.scopes[name] = tempScope;\r\n        return tempScope;\r\n    }\r\n\r\n    // Removes a scope from the system\r\n    public removeScope(name: string): Hotkeys {\r\n        this.scopes[name] = undefined;\r\n        if (name === \"Default\") {\r\n            this.scopes[\"Default\"] = new Scope(\"Default\");\r\n        }\r\n        if (this.currentScope.name === name) {\r\n            this.currentScope = this.scopes[\"Default\"];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    // clears all scopes and creates a new Default scope\r\n    public clear(): Hotkeys {\r\n        this.scopes = {};\r\n        this.scopes[\"Default\"] = new Scope(\"Default\");\r\n        this.currentScope = this.scopes[\"Default\"];\r\n        this.latestKeys = [];\r\n        return this;\r\n    }\r\n\r\n    // adds a sequence to the current scope\r\n    public bind(keyCodes: string, callback: (event: KeyboardEvent, handler: any) => void): IHotkeys {\r\n        this.currentScope.addSequence(keyCodes, callback);\r\n        return this;\r\n    }\r\n\r\n    // removes a sequence from the current scope\r\n    public unbind(keyCodes: string): Hotkeys {\r\n        this.currentScope.removeSequence(keyCodes);\r\n        return this;\r\n    }\r\n\r\n    // Called when a press event is fired\r\n    public press(event: KeyboardEvent): void {\r\n        if (!(this.filter(event))) {\r\n            return;\r\n        }\r\n        let currentKey = this.getKeys(event);\r\n        this.latestKeys.push(currentKey);\r\n        let tempArray = this.latestKeys.slice();\r\n        if (this.currentScope.press(this.latestKeys, event)) {\r\n            this.latestKeys = [];\r\n        } else {\r\n            while (this.latestKeys.length > 0) {\r\n                if (this.currentScope.isPartial(this.latestKeys)) {\r\n                    return;\r\n                }\r\n                this.latestKeys.shift();\r\n            }\r\n            if (this.latestKeys.length === 0) {\r\n                this.currentScope.callDefault(tempArray, event);\r\n            }\r\n        }\r\n    }\r\n\r\n    // gets the string version of the keys currently pressed\r\n    private getKeys(event: KeyboardEvent): number[] {\r\n        let returnValue = [];\r\n        if (event.altKey) {\r\n            returnValue.push(Globals.keyMappings[\"ALT\"]);\r\n        }\r\n        if (event.ctrlKey) {\r\n            returnValue.push(Globals.keyMappings[\"CTRL\"]);\r\n        }\r\n        if (event.metaKey) {\r\n            returnValue.push(Globals.keyMappings[\"META\"]);\r\n        }\r\n        if (event.shiftKey) {\r\n            returnValue.push(Globals.keyMappings[\"SHIFT\"]);\r\n        }\r\n        if (returnValue.indexOf(event.keyCode) === -1) {\r\n            returnValue.push(event.keyCode);\r\n        }\r\n        return returnValue;\r\n    }\r\n}","// Dictionary helper class\r\nexport class StringDictionary<VALUET> {\r\n    [key: string]: VALUET;\r\n}","import { StringDictionary } from '../Types/StringDictionary'\r\n\r\n//An individual path part\r\nexport class PathPart {\r\n    //Constructor\r\n    constructor(part: string, defaultValues: StringDictionary<any>) {\r\n        this.variable = part.charAt(0) === '{' && part.charAt(part.length - 1) === '}';\r\n        part = part.replace(/[{}]/g, '');\r\n        this.optional = part.charAt(0) === '^';\r\n        this.part = part.replace(/[\\^]/g, '');\r\n        if (defaultValues[this.part] !== undefined) {\r\n            this.defaultValue = defaultValues[this.part];\r\n        } else {\r\n            this.defaultValue = '';\r\n        }\r\n    }\r\n\r\n    //The actual part of the path to match on\r\n    private part: string;\r\n\r\n    //Is this a variable?\r\n    private variable: boolean;\r\n\r\n    //Is this optional?\r\n    private optional: boolean;\r\n\r\n    //The default value for this part\r\n    private defaultValue: any;\r\n\r\n    //Determines if this is a match.\r\n    public isMatch(part: string): boolean {\r\n        if (part === undefined || part === null) {\r\n            return this.optional;\r\n        }\r\n        part = part;\r\n        if (this.variable) {\r\n            return this.optional || part !== '';\r\n        }\r\n        return this.optional || part.toUpperCase() === this.part.toUpperCase();\r\n    }\r\n\r\n    //Gets the value, if it is a variable. If it is not a variable, it returns undefined and if it is a variable but no\r\n    //value is present it returns null.\r\n    private getValue(part: string): string {\r\n        if (!this.variable) {\r\n            return part || this.defaultValue;\r\n        }\r\n        if (part !== undefined) {\r\n            return part || this.defaultValue;\r\n        } else {\r\n            return this.defaultValue;\r\n        }\r\n    }\r\n\r\n    //Sets the value used for the path part\r\n    public setValue(part: string, parameters: StringDictionary<any>): void {\r\n        let tempValue = this.getValue(part);\r\n        parameters[this.part] = this.getValue(part);\r\n    }\r\n}","import { StringDictionary } from '../Types/StringDictionary'\r\n\r\n// An individual query string part\r\nexport class QueryPart {\r\n    // Constructor\r\n    constructor(part: string, defaultValues: StringDictionary<any>) {\r\n        let tempParts = part.split(\"=\", 2);\r\n        this.key = tempParts[0];\r\n        part = tempParts[1];\r\n        this.variable = part.charAt(0) === \"{\" && part.charAt(part.length - 1) === \"}\";\r\n        part = part.replace(/[{}]/g, \"\");\r\n        this.optional = part.charAt(0) === \"^\";\r\n        this.part = part.replace(/[\\^]/g, \"\");\r\n        if (defaultValues[this.part] !== undefined) {\r\n            this.defaultValue = defaultValues[this.part];\r\n        } else {\r\n            this.defaultValue = \"\";\r\n        }\r\n    }\r\n\r\n    // The actual part of the path to match on\r\n    private part: string;\r\n\r\n    // The key portion of the query string part\r\n    private key: string;\r\n\r\n    // Is this a variable?\r\n    private variable: boolean;\r\n\r\n    // Is this optional?\r\n    private optional: boolean;\r\n\r\n    // The default value for this part\r\n    private defaultValue: any;\r\n\r\n    // Determines if this is a match.\r\n    public isMatch(part: string): boolean {\r\n        if (part === undefined || part === null) {\r\n            return false;\r\n        }\r\n        let tempParts = part.split(\"=\", 2);\r\n        if (tempParts.length !== 2) {\r\n            return false;\r\n        }\r\n        if (this.key.toUpperCase() !== tempParts[0].toUpperCase()) {\r\n            return false;\r\n        }\r\n        part = tempParts[1];\r\n        if (part === undefined) {\r\n            return this.optional;\r\n        }\r\n        if (this.variable) {\r\n            return this.optional || part !== \"\";\r\n        }\r\n        return this.optional || part.toUpperCase() === this.part.toUpperCase();\r\n    }\r\n\r\n    // Gets the value, if it is a variable. If it is not a variable, it returns undefined and if it is a variable but no\r\n    // value is present it returns null.\r\n    private getValue(part: string): string {\r\n        if (part === undefined || part === null) {\r\n            return this.defaultValue;\r\n        }\r\n        let tempParts = part.split(\"=\", 2);\r\n        if (tempParts.length !== 2) {\r\n            return this.defaultValue;\r\n        }\r\n        part = tempParts[1];\r\n        if (!this.variable) {\r\n            return part || this.defaultValue;\r\n        }\r\n        if (part !== undefined) {\r\n            return part || this.defaultValue;\r\n        } else {\r\n            return this.defaultValue;\r\n        }\r\n    }\r\n\r\n    // Sets the value used for the path part\r\n    public setValue(part: string, parameters: StringDictionary<any>): void {\r\n        let tempValue = this.getValue(part);\r\n        parameters[this.key] = this.getValue(part);\r\n    }\r\n}","import { StringDictionary } from '../Types/StringDictionary'\r\n\r\n// An individual hash part\r\nexport class HashPart {\r\n    // Constructor\r\n    constructor(part: string, defaultValues: StringDictionary<any>) {\r\n        part = part.replace(/[#!]/g, \"\");\r\n        this.variable = part.charAt(0) === \"{\" && part.charAt(part.length - 1) === \"}\";\r\n        part = part.replace(/[{}]/g, \"\");\r\n        this.optional = part.charAt(0) === \"^\";\r\n        this.part = part.replace(/[\\^]/g, \"\");\r\n        if (defaultValues[this.part] !== undefined) {\r\n            this.defaultValue = defaultValues[this.part];\r\n        } else {\r\n            this.defaultValue = \"\";\r\n        }\r\n    }\r\n\r\n    // The actual part of the path to match on\r\n    private part: string;\r\n\r\n    // Is this a variable?\r\n    private variable: boolean;\r\n\r\n    // Is this optional?\r\n    private optional: boolean;\r\n\r\n    // The default value for this part\r\n    private defaultValue: any;\r\n\r\n    // Determines if this is a match.\r\n    public isMatch(part: string): boolean {\r\n        if (part === undefined || part === null) {\r\n            return this.optional;\r\n        }\r\n        part = part.replace(/[#!]/g, \"\");\r\n        if (this.variable) {\r\n            return this.optional || part !== \"\";\r\n        }\r\n        return this.optional || part.toUpperCase() === this.part.toUpperCase();\r\n    }\r\n\r\n    // Gets the value, if it is a variable. If it is not a variable, it returns undefined and if it is a variable but no\r\n    // value is present it returns null.\r\n    private getValue(part: string): string {\r\n        if (!this.variable) {\r\n            return part || this.defaultValue;\r\n        }\r\n        if (part !== undefined) {\r\n            return part || this.defaultValue;\r\n        } else {\r\n            return this.defaultValue;\r\n        }\r\n    }\r\n\r\n    // Sets the value used for the path part\r\n    public setValue(part: string, parameters: StringDictionary<any>): void {\r\n        part = part ? part : \"\";\r\n        part = part.replace(/[#!]/g, \"\");\r\n        parameters[this.part] = this.getValue(part);\r\n    }\r\n}","import { StringDictionary } from '../Types/StringDictionary'\r\nimport { PathPart } from './PathPart'\r\nimport { QueryPart } from './QueryPart'\r\nimport { HashPart } from './HashPart'\r\n\r\n// An individual route\r\nexport class Route {\r\n    // Constructor\r\n    constructor(url: string, callback: (parameters: StringDictionary<any>) => void, defaultValues?: StringDictionary<any>) {\r\n        if (defaultValues === undefined) {\r\n            defaultValues = new StringDictionary<any>();\r\n        }\r\n        this.url = this.fixUrl(url);\r\n        this.pathParts = this.getPathParts(this.url).map(x => new PathPart(x, defaultValues));\r\n        this.pathParts = this.pathParts ? this.pathParts : [];\r\n        this.queryParts = this.getQueryParts(this.url).map(x => new QueryPart(x, defaultValues));\r\n        this.queryParts = this.queryParts ? this.queryParts : [];\r\n        this.hashParts = this.getHashParts(this.url).map(x => new HashPart(x, defaultValues));\r\n        this.hashParts = this.hashParts ? this.hashParts : [];\r\n        this.callbacks = [callback];\r\n        this.defaultValues = defaultValues;\r\n    }\r\n\r\n    // URL path parts of the path\r\n    private pathParts: PathPart[];\r\n\r\n    // Query string parts of the path\r\n    private queryParts: QueryPart[];\r\n\r\n    private hashParts: HashPart[];\r\n\r\n    // Default values for this path\r\n    private defaultValues: StringDictionary<any>;\r\n\r\n    // URL that matches with the individual route\r\n    private url: string;\r\n\r\n    // Callback function to call\r\n    private callbacks: { (parameters: StringDictionary<any>): void }[];\r\n\r\n    // Determines if the url passed in equals the current route\r\n    public isRoute(url: string): boolean {\r\n        return this.url === this.fixUrl(url);\r\n    }\r\n\r\n    // adds a callback to the route\r\n    public addCallback(callback: (parameters: StringDictionary<any>) => void): void {\r\n        this.callbacks.push(callback);\r\n    }\r\n\r\n    // removes a callback from the route\r\n    public removeCallback(callback: (parameters: StringDictionary<any>) => void): void {\r\n        this.callbacks = this.callbacks.filter(x => x !== callback);\r\n    }\r\n\r\n    // Fixes a url that is passed in\r\n    private fixUrl(url: string): string {\r\n        if (!url.length) {\r\n            return url;\r\n        }\r\n        return url.replace(/^\\//, \"\").replace(/\\/+/g, \"/\").replace(/^\\/|\\/($|\\?)/, \"\").replace(/\\/\\#/g, \"#\");\r\n    }\r\n\r\n    // Get the path parts for the route\r\n    private getPathParts(url: string): string[] {\r\n        return url.split(\"?\", 2)[0].split(\"#\", 2)[0].split(\"/\");\r\n    }\r\n\r\n    // Gets the hash code portion of the url\r\n    private getHashParts(url: string): string[] {\r\n        let urlSplit = url.split(\"?\", 2)[0].split(\"#\", 2);\r\n        return (urlSplit.length < 2) ? [] : [urlSplit[1].replace(\"!\", \"\")];\r\n    }\r\n\r\n    // Gets the query string parts of the url\r\n    private getQueryParts(url: string): string[] {\r\n        let urlSplit = url.split(\"?\", 2);\r\n        if (urlSplit.length < 2) {\r\n            return [];\r\n        }\r\n        url = urlSplit[1];\r\n        return url ? url.split(\"&\") : [];\r\n    }\r\n\r\n    // Gets the parameters from the url specified\r\n    private getParametersFromUrl(pathParts: string[], queryParts: string[], hashParts: string[]): StringDictionary<any> {\r\n        let parameters = new StringDictionary<any>();\r\n        for (let x = 0; x < pathParts.length; ++x) {\r\n            this.pathParts[x].setValue(pathParts[x], parameters);\r\n        }\r\n        for (let x = 0; x < queryParts.length; ++x) {\r\n            this.queryParts[x].setValue(queryParts[x], parameters);\r\n        }\r\n        for (let x = 0; x < hashParts.length; ++x) {\r\n            this.hashParts[x].setValue(hashParts[x], parameters);\r\n        }\r\n        if (this.pathParts.length > pathParts.length) {\r\n            for (let x = pathParts.length; x < this.pathParts.length; ++x) {\r\n                this.pathParts[x].setValue(\"\", parameters);\r\n            }\r\n        }\r\n        if (this.queryParts.length > queryParts.length) {\r\n            for (let x = queryParts.length; x < this.queryParts.length; ++x) {\r\n                this.queryParts[x].setValue(\"\", parameters);\r\n            }\r\n        }\r\n        if (this.hashParts.length > hashParts.length) {\r\n            for (let x = hashParts.length; x < this.hashParts.length; ++x) {\r\n                this.hashParts[x].setValue(\"\", parameters);\r\n            }\r\n        }\r\n        return parameters;\r\n    }\r\n\r\n    // Determines if the route is a match\r\n    private isMatch(pathParts: string[], queryParts: string[], hashParts: string[]): boolean {\r\n        if (this.pathParts.length < pathParts.length) {\r\n            return false;\r\n        }\r\n        for (let x = 0; x < pathParts.length; ++x) {\r\n            if (!this.pathParts[x].isMatch(pathParts[x])) {\r\n                return false;\r\n            }\r\n        }\r\n        if (this.pathParts.length > pathParts.length) {\r\n            for (let x = pathParts.length; x < this.pathParts.length; ++x) {\r\n                if (!this.pathParts[x].isMatch(\"\")) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.queryParts.length < queryParts.length) {\r\n            return false;\r\n        }\r\n        for (let x = 0; x < queryParts.length; ++x) {\r\n            if (!this.queryParts[x].isMatch(queryParts[x])) {\r\n                return false;\r\n            }\r\n        }\r\n        if (this.queryParts.length > queryParts.length) {\r\n            for (let x = queryParts.length; x < this.queryParts.length; ++x) {\r\n                if (!this.queryParts[x].isMatch(\"\")) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.hashParts.length < hashParts.length) {\r\n            return false;\r\n        }\r\n        for (let x = 0; x < hashParts.length; ++x) {\r\n            if (!this.hashParts[x].isMatch(hashParts[x])) {\r\n                return false;\r\n            }\r\n        }\r\n        if (this.hashParts.length > hashParts.length) {\r\n            for (let x = hashParts.length; x < this.hashParts.length; ++x) {\r\n                if (!this.hashParts[x].isMatch(\"\")) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    // Calls the route's callback function\r\n    public run(url: string): boolean {\r\n        url = this.fixUrl(url);\r\n        let pathParts = this.getPathParts(url);\r\n        let queryParts = this.getQueryParts(url);\r\n        let hashParts = this.getHashParts(url);\r\n        if (!this.isMatch(pathParts, queryParts, hashParts)) {\r\n            return false;\r\n        }\r\n        let parameters = this.getParametersFromUrl(pathParts, queryParts, hashParts);\r\n        parameters[\"url\"] = url;\r\n        this.callbacks.forEach(x => x(parameters));\r\n        return true;\r\n    }\r\n}","import { StringDictionary } from '../Types/StringDictionary'\r\nimport { IRouter } from './Interfaces/IRouter'\r\nimport { Route } from './Route'\r\nimport { RouteData } from './DataTypes/RouteData'\r\n\r\n// Does basic path routing\r\nexport class Router implements IRouter {\r\n    // Constructor\r\n    constructor() {\r\n        this.routes = [];\r\n    }\r\n\r\n    // List of routes the system has currently\r\n    private routes: Route[];\r\n\r\n    // Maps a set of routes to the action specified\r\n    public map(route: RouteData[]): void {\r\n        for (let x = 0; x < route.length; ++x) {\r\n            this.addRoute(route[x].url, route[x].action, route[x].defaultValues);\r\n        }\r\n    }\r\n\r\n    // Adds a route to the router\r\n    public addRoute(url: string, callback: (parameters: StringDictionary<any>) => void, defaultValues?: StringDictionary<any>): Router {\r\n        let routes = this.routes.filter(x => x.isRoute(url));\r\n        if (routes.length === 0) {\r\n            this.routes.push(new Route(url, callback, defaultValues));\r\n        } else {\r\n            routes[0].addCallback(callback);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    // Runs the url specified and returns true if it ran successfully, false otherwise.\r\n    public run(url: string): boolean {\r\n        for (let x = 0; x < this.routes.length; ++x) {\r\n            if (this.routes[x].run(url)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}","// Wrapper for history object\r\nexport class PageHistory {\r\n    // Goes back by the value specified\r\n    public back(delta?: number): void {\r\n        if (delta === undefined) {\r\n            delta = 1;\r\n        }\r\n        window.history.go(-1 * delta);\r\n    }\r\n\r\n    // Goes forward by the value specified\r\n    public forward(delta?: number): void {\r\n        if (delta === undefined) {\r\n            delta = 1;\r\n        }\r\n        window.history.go(delta);\r\n    }\r\n\r\n    // pushes a new url/state onto the history\r\n    public push(state: any, url?: string, title?: string): void {\r\n        window.history.pushState(state, title, url);\r\n    }\r\n\r\n    // replaces the current url with a new url/state\r\n    public replace(state: any, url?: string, title?: string): void {\r\n        window.history.replaceState(state, title, url);\r\n    }\r\n\r\n    // gets the current state\r\n    get state(): any {\r\n        return window.history.state;\r\n    }\r\n\r\n    // Returns the number of items in storage\r\n    get length(): number {\r\n        return window.history.length;\r\n    }\r\n}","import { FormValidation } from \"./Validation/FormValidation\";\r\nimport { ErrorLogging } from \"./Logging/ErrorLogging\";\r\nimport { LocalStorage } from \"./WebStorage/LocalStorage\";\r\nimport { SessionStorage } from \"./WebStorage/SessionStorage\";\r\nimport { Request, StorageMode } from \"./AJAX/Request\";\r\nimport { DatabaseConnection } from \"./Database/Database\";\r\nimport { BrowserUtils } from \"./Browser/BrowserUtils\";\r\n\r\nimport { Hotkeys } from \"./Hotkey/Hotkeys\";\r\nimport { Router } from \"./Router/Router\";\r\nimport { PageHistory } from \"./History/PageHistory\";\r\nimport { Downloader } from \"./IO/Downloader\";\r\n\r\n// Starts up and generally manages the framework\r\nclass Framework {\r\n    // constructor\r\n    constructor() {\r\n        this.validation = new FormValidation();\r\n        this.errorLogger = new ErrorLogging();\r\n        this.localStorage = new LocalStorage();\r\n        this.sessionStorage = new SessionStorage();\r\n        this.hotkeys = new Hotkeys();\r\n        this.router = new Router();\r\n        this.history = new PageHistory();\r\n\r\n        window.addEventListener(\"keydown\", x => this.hotkeys.press(x));\r\n        window.addEventListener(\"load\", x => this.validation.initialize(), false);\r\n        window.onerror = (msg, url, ln, col, error) => {\r\n            this.errorLogger.onError(msg.toString(), url, ln, col, error);\r\n        };\r\n        this.errorLogger.setLoggingFunction((message: string, stack: string) => { console.log(message); });\r\n    }\r\n\r\n    // the hotkeys object\r\n    public hotkeys: Hotkeys;\r\n\r\n    // The router object\r\n    public router: Router;\r\n\r\n    // The form validation object\r\n    public validation: FormValidation;\r\n\r\n    // The error logging object\r\n    public errorLogger: ErrorLogging;\r\n\r\n    // The page history object\r\n    public history: PageHistory;\r\n\r\n    // The local storage object\r\n    public localStorage: LocalStorage;\r\n\r\n    // The session storage object\r\n    public sessionStorage: SessionStorage;\r\n}\r\n\r\nexport { Request, DatabaseConnection, Framework, StorageMode, BrowserUtils, Downloader };","import Vue from 'vue';\r\n\r\nlet clickOutside: any = {\r\n    bind: function (el: any) {\r\n        clickOutside.onEventBound = clickOutside.onEvent.bind({ el });\r\n        document.addEventListener(\"click\", clickOutside.onEventBound);\r\n    },\r\n    cb: function (event: any) {\r\n        return;\r\n    },\r\n    onEvent: function (event: { target: any; }) {\r\n        if (event.target === this.el || this.el.contains(event.target) || clickOutside.cb) {\r\n            clickOutside.cb(event);\r\n        }\r\n    },\r\n    onEventBound: function () {\r\n        return;\r\n    },\r\n    unbind: function () {\r\n        document.removeEventListener(\"click\", clickOutside.onEventBound);\r\n    },\r\n    update: function (el: any, binding: { value: (event: any) => void; }) {\r\n        if (typeof binding.value !== \"function\") {\r\n            throw new Error(\"Argument must be a function\");\r\n        }\r\n        clickOutside.cb = binding.value;\r\n    },\r\n};\r\n\r\nexport function RegisterDirectives(app: Vue.App<Element>): Vue.App<Element> {\r\n    app.directive(\"click-outside\", clickOutside);\r\n    return app;\r\n}","// Basic component schema\r\nexport default class ComponentSchema {\r\n    // Component type\r\n    public type: string;\r\n\r\n    // Children components\r\n    public children: ComponentSchema[];\r\n}","declare global {\r\n    interface String {\r\n        slugify(): string;\r\n        stripHTML(): string;\r\n        toNumber(): number;\r\n        replaceAll(): string;\r\n    }\r\n}\r\n\r\n// \"slugifies\" the string.\r\nString.prototype.slugify = function (): string {\r\n    return this.trim().replace(/ /g, \"-\").replace(/-{2,}/g, \"-\").replace(/^-+|-+$/g, \"\").replace(/([^a-zA-Z0-9-_/./:]+)/g, \"\");\r\n};\r\n\r\n// Strips out HTML\r\nString.prototype.stripHTML = function (): string {\r\n    let tempDiv = document.createElement(\"div\");\r\n    tempDiv.innerHTML = this;\r\n    return (tempDiv.textContent || tempDiv.innerText || \"\").replace(/^\\s+|\\s+$/g, \"\");\r\n};\r\n\r\n// Converts it to a number, stripping out non numeric values\r\nString.prototype.toNumber = function (): number {\r\n    if (this == null)\r\n        return 0;\r\n    return parseFloat(this.stripHTML().replace(/[^0-9.-]/g, \"\"));\r\n};\r\n\r\nexport { }","<template>\r\n    <div>\r\n        ASDF\r\n        <component\r\n            v-for=\"component in schema.children\"\r\n            :key=\"component.type\"\r\n            :is=\"component.type\"\r\n            :data=\"internalData\"\r\n            :schema=\"component\"\r\n            @save=\"saveData\"\r\n            @delete=\"deleteData\"\r\n            @load=\"fetchData\">\r\n        </component>\r\n        <pre>{{internalData}}</pre>\r\n    </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { Request, StorageMode } from '../Framework/AJAX/Request';\r\nimport ComponentSchema from \"./DataTypes/ComponentSchema\";\r\nimport \"../Framework/Extensions/String\";\r\nimport Vue from 'vue';\r\n\r\nexport default Vue.defineComponent({\r\n    name: \"DataHandler\",\r\n    data: function() {\r\n        return {\r\n            count: 0,\r\n            timer: 0,\r\n            internalData: this.model\r\n        };\r\n    },\r\n    props: {\r\n        model: {\r\n            type: Object,\r\n            default: {}\r\n        },\r\n        schema: {\r\n            type: ComponentSchema,\r\n            default: new ComponentSchema()\r\n        }\r\n    },\r\n    methods: {\r\n        fetchData: function() {\r\n            if(!this.schema.loadUrl) {\r\n                return;\r\n            }\r\n            let that = this;\r\n            Request.post('/api/query', {\r\n                query: that.schema.datalistQuery\r\n            })\r\n            .onSuccess((data: any)=>{\r\n                that.schema.datalist = data.data.dropDown;\r\n            })\r\n            .setMode(StorageMode.StorageAndUpdate)\r\n            .send();\r\n        },\r\n        saveData: function() {\r\n            let that = this;\r\n        },\r\n        deleteData: function() {\r\n            let that = this;\r\n        }\r\n    },\r\n    created: function() {\r\n        if(!this.schema.datalistQuery) {\r\n            return;\r\n        }\r\n        let that = this;\r\n    },\r\n    watch: {\r\n        model: function(newModel, oldModel) {\r\n            if (oldModel === newModel) {\r\n                return;\r\n            }\r\n            this.internalModel = newModel;\r\n        },\r\n    }\r\n});\r\n\r\n</script>","<template>\r\n    <div>\r\n        ASDF\r\n        <component\r\n            v-for=\"component in schema.children\"\r\n            :key=\"component.type\"\r\n            :is=\"component.type\"\r\n            :data=\"internalData\"\r\n            :schema=\"component\"\r\n            @save=\"saveData\"\r\n            @delete=\"deleteData\"\r\n            @load=\"fetchData\">\r\n        </component>\r\n        <pre>{{internalData}}</pre>\r\n    </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { Request, StorageMode } from '../Framework/AJAX/Request';\r\nimport ComponentSchema from \"./DataTypes/ComponentSchema\";\r\nimport \"../Framework/Extensions/String\";\r\nimport Vue from 'vue';\r\n\r\nexport default Vue.defineComponent({\r\n    name: \"DataHandler\",\r\n    data: function() {\r\n        return {\r\n            count: 0,\r\n            timer: 0,\r\n            internalData: this.model\r\n        };\r\n    },\r\n    props: {\r\n        model: {\r\n            type: Object,\r\n            default: {}\r\n        },\r\n        schema: {\r\n            type: ComponentSchema,\r\n            default: new ComponentSchema()\r\n        }\r\n    },\r\n    methods: {\r\n        fetchData: function() {\r\n            if(!this.schema.loadUrl) {\r\n                return;\r\n            }\r\n            let that = this;\r\n            Request.post('/api/query', {\r\n                query: that.schema.datalistQuery\r\n            })\r\n            .onSuccess((data: any)=>{\r\n                that.schema.datalist = data.data.dropDown;\r\n            })\r\n            .setMode(StorageMode.StorageAndUpdate)\r\n            .send();\r\n        },\r\n        saveData: function() {\r\n            let that = this;\r\n        },\r\n        deleteData: function() {\r\n            let that = this;\r\n        }\r\n    },\r\n    created: function() {\r\n        if(!this.schema.datalistQuery) {\r\n            return;\r\n        }\r\n        let that = this;\r\n    },\r\n    watch: {\r\n        model: function(newModel, oldModel) {\r\n            if (oldModel === newModel) {\r\n                return;\r\n            }\r\n            this.internalModel = newModel;\r\n        },\r\n    }\r\n});\r\n\r\n</script>","// import Form from \"../Form.vue\";\r\n// import Tabs from \"../Tabs.vue\";\r\nimport DataHandler from \"../DataHandler.vue\";\r\nimport Vue from \"vue\";\r\n\r\nexport default (app: Vue.App<Element>) => {\r\n    app.component('mithril-data-handler', DataHandler);\r\n    // app.component('mithril-tabs', Tabs);\r\n    // app.component('mithril-form', Form);\r\n};","import Vue from \"vue\";\r\nimport { RegisterDirectives } from \"./VueDirectives\";\r\nimport { RegisterFilters } from \"./VueFilters\";\r\nimport VueComponents from \"./VueComponents\";\r\n\r\nexport default {\r\n    install: (app: Vue.App<Element>, options: any) => {\r\n        RegisterFilters(app);\r\n        RegisterDirectives(app);\r\n        VueComponents(app);\r\n    }\r\n}","import Vue from 'vue';\r\nimport moment from 'moment';\r\n\r\nexport function RegisterFilters(app: Vue.App<Element>): Vue.App<Element> {\r\n    if (app == null) {\r\n        return app;\r\n    }\r\n    app.config.globalProperties.$filters = {\r\n        moment: function (date: Date, format: string, parsingFormat?: string) {\r\n            if (date == null) {\r\n                return \"N/A\";\r\n            }\r\n            parsingFormat ??= \"YYYY-MM-DDThh:mm:ss\";\r\n            format ??= \"M-D-YYYY h:mm A\";\r\n            return moment(date, parsingFormat).format(format);\r\n        },\r\n        capitalize: function (str: string) {\r\n            if (str == null) {\r\n                return \"\";\r\n            }\r\n            return str.charAt(0).toUpperCase() + str.slice(1);\r\n        },\r\n        maxsize: function (value: string, size: number, substitutionString?: string) {\r\n            if (value == null) {\r\n                return \"\";\r\n            }\r\n            if (value.length <= size) {\r\n                return value;\r\n            }\r\n            substitutionString ??= \"...\";\r\n            return value.substring(0, size) + substitutionString;\r\n        },\r\n        currency: function (value: number, locales?: string, format?: Intl.NumberFormatOptions) {\r\n            if (value == null) {\r\n                return \"\";\r\n            }\r\n            locales ??= \"en-US\";\r\n            format ??= { style: 'currency', currency: 'USD' };\r\n            return Intl.NumberFormat(locales, format).format(value);\r\n        }\r\n    };\r\n    return app;\r\n}","import { Framework, DatabaseConnection, Request, StorageMode, BrowserUtils, Downloader } from \"./Framework/Framework\";\r\nimport MithrilPlugin from \"./Component/VueExtensions/MithrilPlugin\";\r\n\r\nimport Vue from 'vue';\r\n\r\n// Starts up and generally manages the framework\r\nclass Mithril {\r\n    // constructor\r\n    constructor() {\r\n        this.framework = new Framework();\r\n        this.setupLogging();\r\n    }\r\n\r\n    // Sets up Vue components\r\n    public SetupComponents(app: Vue.App<Element>): Vue.App<Element> {\r\n        app.use(MithrilPlugin);\r\n        return app;\r\n    }\r\n\r\n    //Framework items\r\n    private framework: Framework;\r\n\r\n    // Set up error logging.\r\n    private setupLogging(): void {\r\n        var errorLogged = false;\r\n        this.framework.errorLogger.setLoggingFunction(function (ex: string, error: string) {\r\n            if (ex === null || errorLogged) {\r\n                return;\r\n            }\r\n            errorLogged = true;\r\n            var url = document.location;\r\n            var stack = error;\r\n            var out = ex;\r\n            out += \": at document path '\" + url + \"'.\";\r\n            if (stack !== null) {\r\n                out += \"\\n at \" + stack;\r\n            }\r\n            Request.post(\"API/Command/v1/Log\", { logLevel: \"Error\", message: out }).send();\r\n        });\r\n    }\r\n}\r\n\r\nexport { Request, DatabaseConnection, StorageMode, BrowserUtils, Mithril, Downloader };","﻿import { BrowserUtils, DatabaseConnection, Mithril, Request, StorageMode, Downloader } from \"../../../Mithril.Web.Common/build/ts/Mithril\";\r\n\r\nexport class ThemeStartup {\r\n    constructor() {\r\n        this.Core = new Mithril();\r\n    }\r\n\r\n    public Core: Mithril;\r\n}"],"names":["HTMLElement","prototype","getParentByClass","className","element","this","parentElement","hasClass","indexOf","replaceClass","originalClassName","newClassName","tempClassName","replace","RegExp","trim","addClass","toggleClass","removeClass","show","hide","attribute","name","value","setAttribute","getAttribute","NodeList","map","callback","ReturnValues","x","length","concat","filter","FormValidation","constructor","errors","messageAttributes","initialize","inputElements","document","getElementsByTagName","willValidate","type","toUpperCase","addEventListener","y","inputHandler","target","invalidInputHandler","textAreaElements","textAreaHandler","invalidTextAreaHandler","selectElements","selectHandler","invalidSelectHandler","elements","initializeForm","form","input","validity","valid","errorMessages","getErrorMessages","setCustomValidity","join","textarea","select","getElementsByName","checkValidity","validate","result","validateInput","validateSelect","textareaElements","validateTextArea","validateForm","validateElement","tagName","tempResults","tempValue","key","message","generalMessage","validationMessage","Signature","params","toString","Function","trace","curr","push","signature","caller","getName","arguments","i","definition","split","exp","test","ErrorLogging","logError","ex","stack","setLoggingFunction","logger","onError","filename","lineno","colno","error","LocalStorage","set","localStorage","setItem","setObject","JSON","stringify","get","defaultValue","getItem","has","remove","removeItem","clear","index","getObject","parse","SessionStorage","sessionStorage","DatabaseConnection","dbName","tables","version","DBName","Version","request","indexedDB","open","onupgradeneeded","ev","database","table","objectStoreNames","contains","deleteObjectStore","createObjectStore","onsuccess","openDatabase","add","obj","transaction","objectStore","put","delete","getByKey","onSuccess","getKeys","getAllKeys","query","getAll","Request","method","url","data","headers","Headers","accept","parser","json","serializer","storageMode","StorageMode","NetworkOnly","databaseName","cacheKey","credentials","static","makeRequest","success","setHeader","setCacheKey","setCredentials","setParser","setMode","setSerializer","send","undefined","serializedData","StorageFirst","returnValueFromDB","queryNetwork","response","saveValueToDB","StorageAndUpdate","NetworkFirst","dataKey","Date","now","offlineCallback","onlineCallback","navigator","onLine","fetch","body","then","catch","event","FileTypes","Globals","keyMappings","BACKSPACE","TAB","ENTER","SHIFT","CTRL","ALT","PAUSE","CAPSLOCK","ESCAPE","SPACE","PAGEUP","PAGEDOWN","END","HOME","LEFT","UP","RIGHT","DOWN","INS","DEL","META","MINUS","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","NUMLOCK","SCROLLLOCK","Keypress","keys","keyCode","charCodeAt","isPressed","keysPressed","Sequence","keyCodes","keyCodeSequence","isDefault","call","scope","press","individualCodes","isPartial","Scope","sequences","sort","callDefault","defaultItems","addSequence","removeSequence","Hotkeys","scopes","currentScope","srcElement","latestKeys","setScope","addScope","tempScope","removeScope","bind","unbind","currentKey","tempArray","slice","shift","returnValue","altKey","ctrlKey","metaKey","shiftKey","StringDictionary","PathPart","part","defaultValues","variable","charAt","optional","isMatch","getValue","setValue","parameters","QueryPart","tempParts","HashPart","Route","fixUrl","pathParts","getPathParts","queryParts","getQueryParts","hashParts","getHashParts","callbacks","isRoute","addCallback","removeCallback","urlSplit","getParametersFromUrl","run","forEach","Router","routes","route","addRoute","action","PageHistory","back","delta","window","history","go","forward","state","title","pushState","replaceState","Framework","validation","errorLogger","hotkeys","router","onerror","msg","ln","col","console","log","clickOutside","el","onEventBound","onEvent","cb","removeEventListener","update","binding","Error","ComponentSchema","String","slugify","stripHTML","tempDiv","createElement","innerHTML","textContent","innerText","toNumber","parseFloat","script","Vue","defineComponent","count","timer","internalData","model","props","Object","default","schema","methods","fetchData","loadUrl","that","post","datalistQuery","datalist","dropDown","saveData","deleteData","created","watch","newModel","oldModel","internalModel","_createElementBlock","_openBlock","createElementBlock","_Fragment","_renderList","renderList","_ctx","children","component","_createBlock","createBlock","_resolveDynamicComponent","resolveDynamicComponent","onSave","onDelete","onLoad","_createElementVNode","createElementVNode","MithrilPlugin","install","app","options","config","globalProperties","$filters","moment","date","format","parsingFormat","capitalize","str","maxsize","size","substitutionString","substring","currency","locales","style","Intl","NumberFormat","RegisterFilters","directive","RegisterDirectives","DataHandler","VueComponents","Mithril","framework","setupLogging","SetupComponents","use","errorLogged","out","location","logLevel","Core"],"mappings":"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"}